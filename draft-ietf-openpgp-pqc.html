<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Post-Quantum Cryptography in OpenPGP</title>
<meta content="Stavros Kousidis" name="author">
<meta content="Johannes Roth" name="author">
<meta content="Falko Strenzke" name="author">
<meta content="Aron Wussler" name="author">
<meta content="
       This document defines a post-quantum public-key algorithm extension for the OpenPGP protocol.
Given the generally assumed threat of a cryptographically relevant quantum computer, this extension provides a basis for long-term secure OpenPGP signatures and ciphertexts.
Specifically, it defines composite public-key encryption based on ML-KEM (formerly CRYSTALS-Kyber), composite public-key signatures based on ML-DSA (formerly CRYSTALS-Dilithium), both in combination with elliptic curve cryptography, and SLH-DSA-SHAKE (formerly SPHINCS+) as a standalone public key signature scheme. 
    " name="description">
<meta content="xml2rfc 3.21.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-openpgp-pqc-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.21.0
    Python 3.12.3
    ConfigArgParse 1.7
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.4
    lxml 4.9.4
    platformdirs 4.2.2
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.31.0
    setuptools 69.5.1
    six 1.16.0
    wcwidth 0.2.13
-->
<link href="draft-ietf-openpgp-pqc.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">PQC in OpenPGP</td>
<td class="right">June 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Kousidis, et al.</td>
<td class="center">Expires 26 December 2024</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-openpgp-pqc-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-06-24" class="published">24 June 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2024-12-26">26 December 2024</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">S. Kousidis</div>
<div class="org">BSI</div>
</div>
<div class="author">
      <div class="author-name">J. Roth</div>
<div class="org">MTG AG</div>
</div>
<div class="author">
      <div class="author-name">F. Strenzke</div>
<div class="org">MTG AG</div>
</div>
<div class="author">
      <div class="author-name">A. Wussler</div>
<div class="org">Proton AG</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Post-Quantum Cryptography in OpenPGP</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines a post-quantum public-key algorithm extension for the OpenPGP protocol.
Given the generally assumed threat of a cryptographically relevant quantum computer, this extension provides a basis for long-term secure OpenPGP signatures and ciphertexts.
Specifically, it defines composite public-key encryption based on ML-KEM (formerly CRYSTALS-Kyber), composite public-key signatures based on ML-DSA (formerly CRYSTALS-Dilithium), both in combination with elliptic curve cryptography, and SLH-DSA-SHAKE (formerly SPHINCS+) as a standalone public key signature scheme.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-ietf-openpgp-pqc/">https://datatracker.ietf.org/doc/draft-ietf-openpgp-pqc/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        WG Working Group mailing list (<span><a href="mailto:openpgp@ietf.org">mailto:openpgp@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/openpgp/">https://mailarchive.ietf.org/arch/browse/openpgp/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/openpgp/">https://www.ietf.org/mailman/listinfo/openpgp/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/openpgp-pqc/draft-openpgp-pqc">https://github.com/openpgp-pqc/draft-openpgp-pqc</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 26 December 2024.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-conventions-used-in-this-do" class="internal xref">Conventions used in this Document</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1.2.1">
                    <p id="section-toc.1-1.1.2.1.2.1.1" class="keepWithNext"><a href="#section-1.1.1" class="auto internal xref">1.1.1</a>.  <a href="#name-terminology-for-multi-algor" class="internal xref">Terminology for Multi-Algorithm Schemes</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-post-quantum-cryptography" class="internal xref">Post-Quantum Cryptography</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2.2.1">
                    <p id="section-toc.1-1.1.2.2.2.1.1" class="keepWithNext"><a href="#section-1.2.1" class="auto internal xref">1.2.1</a>.  <a href="#name-ml-kem" class="internal xref">ML-KEM</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2.2.2">
                    <p id="section-toc.1-1.1.2.2.2.2.1"><a href="#section-1.2.2" class="auto internal xref">1.2.2</a>.  <a href="#name-ml-dsa" class="internal xref">ML-DSA</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2.2.3">
                    <p id="section-toc.1-1.1.2.2.2.3.1"><a href="#section-1.2.3" class="auto internal xref">1.2.3</a>.  <a href="#name-slh-dsa-shake" class="internal xref">SLH-DSA-SHAKE</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1"><a href="#section-1.3" class="auto internal xref">1.3</a>.  <a href="#name-elliptic-curve-cryptography" class="internal xref">Elliptic Curve Cryptography</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a href="#section-1.4" class="auto internal xref">1.4</a>.  <a href="#name-standalone-and-multi-algori" class="internal xref">Standalone and Multi-Algorithm Schemes</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4.2.1">
                    <p id="section-toc.1-1.1.2.4.2.1.1"><a href="#section-1.4.1" class="auto internal xref">1.4.1</a>.  <a href="#name-standalone-and-composite-mu" class="internal xref">Standalone and Composite Multi-Algorithm Schemes</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4.2.2">
                    <p id="section-toc.1-1.1.2.4.2.2.1"><a href="#section-1.4.2" class="auto internal xref">1.4.2</a>.  <a href="#name-non-composite-algorithm-com" class="internal xref">Non-Composite Algorithm Combinations</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-supported-public-key-algori" class="internal xref">Supported Public Key Algorithms</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-algorithm-specifications" class="internal xref">Algorithm Specifications</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.1">
                    <p id="section-toc.1-1.2.2.1.2.1.1"><a href="#section-2.1.1" class="auto internal xref">2.1.1</a>.  <a href="#name-experimental-codepoints-for" class="internal xref">Experimental Codepoints for Interop Testing</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-algorithm-combinations" class="internal xref">Algorithm Combinations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-composite-kems" class="internal xref">Composite KEMs</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-parallel-public-key-encrypt" class="internal xref">Parallel Public-Key Encryption</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-composite-signatures" class="internal xref">Composite Signatures</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-multiple-signatures" class="internal xref">Multiple Signatures</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="auto internal xref">3.5</a>.  <a href="#name-ecc-requirements" class="internal xref">ECC requirements</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-composite-kem-schemes" class="internal xref">Composite KEM schemes</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-building-blocks" class="internal xref">Building Blocks</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="auto internal xref">4.1.1</a>.  <a href="#name-ecdh-kems" class="internal xref">ECDH KEMs</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="auto internal xref">4.1.2</a>.  <a href="#name-ml-kem-2" class="internal xref">ML-KEM</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-composite-encryption-scheme" class="internal xref">Composite Encryption Schemes with ML-KEM</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="auto internal xref">4.2.1</a>.  <a href="#name-fixed-information" class="internal xref">Fixed information</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="auto internal xref">4.2.2</a>.  <a href="#name-key-combiner" class="internal xref">Key combiner</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.3">
                    <p id="section-toc.1-1.4.2.2.2.3.1"><a href="#section-4.2.3" class="auto internal xref">4.2.3</a>.  <a href="#name-key-generation-procedure" class="internal xref">Key generation procedure</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.4">
                    <p id="section-toc.1-1.4.2.2.2.4.1"><a href="#section-4.2.4" class="auto internal xref">4.2.4</a>.  <a href="#name-encryption-procedure" class="internal xref">Encryption procedure</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.5">
                    <p id="section-toc.1-1.4.2.2.2.5.1"><a href="#section-4.2.5" class="auto internal xref">4.2.5</a>.  <a href="#name-decryption-procedure" class="internal xref">Decryption procedure</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-packet-specifications" class="internal xref">Packet specifications</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="auto internal xref">4.3.1</a>.  <a href="#name-public-key-encrypted-sessio" class="internal xref">Public-Key Encrypted Session Key Packets (Tag 1)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.2">
                    <p id="section-toc.1-1.4.2.3.2.2.1"><a href="#section-4.3.2" class="auto internal xref">4.3.2</a>.  <a href="#name-key-material-packets" class="internal xref">Key Material Packets</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-composite-signature-schemes" class="internal xref">Composite Signature Schemes</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-building-blocks-2" class="internal xref">Building blocks</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="auto internal xref">5.1.1</a>.  <a href="#name-eddsa-based-signatures" class="internal xref">EdDSA-Based signatures</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="auto internal xref">5.1.2</a>.  <a href="#name-ml-dsa-signatures" class="internal xref">ML-DSA signatures</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-composite-signature-schemes-" class="internal xref">Composite Signature Schemes with ML-DSA</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="auto internal xref">5.2.1</a>.  <a href="#name-signature-data-digest" class="internal xref">Signature data digest</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="auto internal xref">5.2.2</a>.  <a href="#name-key-generation-procedure-2" class="internal xref">Key generation procedure</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3">
                    <p id="section-toc.1-1.5.2.2.2.3.1"><a href="#section-5.2.3" class="auto internal xref">5.2.3</a>.  <a href="#name-signature-generation" class="internal xref">Signature Generation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.4">
                    <p id="section-toc.1-1.5.2.2.2.4.1"><a href="#section-5.2.4" class="auto internal xref">5.2.4</a>.  <a href="#name-signature-verification" class="internal xref">Signature Verification</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-packet-specifications-2" class="internal xref">Packet Specifications</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.1">
                    <p id="section-toc.1-1.5.2.3.2.1.1"><a href="#section-5.3.1" class="auto internal xref">5.3.1</a>.  <a href="#name-signature-packet-tag-2" class="internal xref">Signature Packet (Tag 2)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.2">
                    <p id="section-toc.1-1.5.2.3.2.2.1"><a href="#section-5.3.2" class="auto internal xref">5.3.2</a>.  <a href="#name-key-material-packets-2" class="internal xref">Key Material Packets</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-slh-dsa-shake-2" class="internal xref">SLH-DSA-SHAKE</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-the-slh-dsa-shake-algorithm" class="internal xref">The SLH-DSA-SHAKE Algorithms</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a href="#section-6.1.1" class="auto internal xref">6.1.1</a>.  <a href="#name-signature-data-digest-2" class="internal xref">Signature Data Digest</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.2">
                    <p id="section-toc.1-1.6.2.1.2.2.1"><a href="#section-6.1.2" class="auto internal xref">6.1.2</a>.  <a href="#name-key-generation" class="internal xref">Key generation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.3">
                    <p id="section-toc.1-1.6.2.1.2.3.1"><a href="#section-6.1.3" class="auto internal xref">6.1.3</a>.  <a href="#name-signature-generation-2" class="internal xref">Signature Generation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.4">
                    <p id="section-toc.1-1.6.2.1.2.4.1"><a href="#section-6.1.4" class="auto internal xref">6.1.4</a>.  <a href="#name-signature-verification-2" class="internal xref">Signature Verification</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-packet-specifications-3" class="internal xref">Packet specifications</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="auto internal xref">6.2.1</a>.  <a href="#name-signature-packet-tag-2-2" class="internal xref">Signature Packet (Tag 2)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.2">
                    <p id="section-toc.1-1.6.2.2.2.2.1"><a href="#section-6.2.2" class="auto internal xref">6.2.2</a>.  <a href="#name-key-material-packets-3" class="internal xref">Key Material Packets</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-notes-on-algorithms" class="internal xref">Notes on Algorithms</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-symmetric-algorithms-for-se" class="internal xref">Symmetric Algorithms for SEIPD Packets</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-hash-algorithms-for-key-bin" class="internal xref">Hash Algorithms for Key Binding Signatures</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-migration-considerations" class="internal xref">Migration Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-key-preference" class="internal xref">Key preference</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-key-generation-strategies" class="internal xref">Key generation strategies</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-security-aspects-of-composi" class="internal xref">Security Aspects of Composite Signatures</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-hashing-in-ecdh-kem" class="internal xref">Hashing in ECDH-KEM</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="auto internal xref">9.3</a>.  <a href="#name-key-combiner-2" class="internal xref">Key combiner</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a href="#section-9.4" class="auto internal xref">9.4</a>.  <a href="#name-domain-separation-and-bindi" class="internal xref">Domain separation and binding</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.5">
                <p id="section-toc.1-1.9.2.5.1"><a href="#section-9.5" class="auto internal xref">9.5</a>.  <a href="#name-slh-dsa-shake-message-rando" class="internal xref">SLH-DSA-SHAKE Message Randomizer</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.6">
                <p id="section-toc.1-1.9.2.6.1"><a href="#section-9.6" class="auto internal xref">9.6</a>.  <a href="#name-binding-hashes-in-signature" class="internal xref">Binding hashes in signatures with signature algorithms</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.7">
                <p id="section-toc.1-1.9.2.7.1"><a href="#section-9.7" class="auto internal xref">9.7</a>.  <a href="#name-symmetric-algorithms-for-sei" class="internal xref">Symmetric Algorithms for SEIPD Packets</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-additional-considerations" class="internal xref">Additional considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-performance-considerations-" class="internal xref">Performance Considerations for SLH-DSA-SHAKE</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-changelog" class="internal xref">Changelog</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="auto internal xref">12.1</a>.  <a href="#name-draft-wussler-openpgp-pqc-0" class="internal xref">draft-wussler-openpgp-pqc-01</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="auto internal xref">12.2</a>.  <a href="#name-draft-wussler-openpgp-pqc-02" class="internal xref">draft-wussler-openpgp-pqc-02</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a href="#section-12.3" class="auto internal xref">12.3</a>.  <a href="#name-draft-wussler-openpgp-pqc-03" class="internal xref">draft-wussler-openpgp-pqc-03</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.4">
                <p id="section-toc.1-1.12.2.4.1"><a href="#section-12.4" class="auto internal xref">12.4</a>.  <a href="#name-draft-wussler-openpgp-pqc-04" class="internal xref">draft-wussler-openpgp-pqc-04</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.5">
                <p id="section-toc.1-1.12.2.5.1"><a href="#section-12.5" class="auto internal xref">12.5</a>.  <a href="#name-draft-ietf-openpgp-pqc-00" class="internal xref">draft-ietf-openpgp-pqc-00</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.6">
                <p id="section-toc.1-1.12.2.6.1"><a href="#section-12.6" class="auto internal xref">12.6</a>.  <a href="#name-draft-ietf-openpgp-pqc-01" class="internal xref">draft-ietf-openpgp-pqc-01</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.7">
                <p id="section-toc.1-1.12.2.7.1"><a href="#section-12.7" class="auto internal xref">12.7</a>.  <a href="#name-draft-ietf-openpgp-pqc-02" class="internal xref">draft-ietf-openpgp-pqc-02</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.8">
                <p id="section-toc.1-1.12.2.8.1"><a href="#section-12.8" class="auto internal xref">12.8</a>.  <a href="#name-draft-ietf-openpgp-pqc-03" class="internal xref">draft-ietf-openpgp-pqc-03</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-contributors" class="internal xref">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="auto internal xref">14</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#section-14.1" class="auto internal xref">14.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#section-14.2" class="auto internal xref">14.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-test-vectors" class="internal xref">Test Vectors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-sample-v6-pqc-subkey-artifa" class="internal xref">Sample v6 PQC Subkey Artifacts</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-v4-pqc-subkey-artifacts" class="internal xref">V4 PQC Subkey Artifacts</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The OpenPGP protocol supports various traditional public-key algorithms based on the factoring or discrete logarithm problem.
As the security of algorithms based on these mathematical problems is endangered by the advent of quantum computers, there is a need to extend OpenPGP by algorithms that remain secure in the presence of quantum computers.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Such cryptographic algorithms are referred to as post-quantum cryptography.
The algorithms defined in this extension were chosen for standardization by the National Institute of Standards and Technology (NIST) in mid 2022 <span>[<a href="#NISTIR-8413" class="cite xref">NISTIR-8413</a>]</span> as the result of the NIST Post-Quantum Cryptography Standardization process initiated in 2016 <span>[<a href="#NIST-PQC" class="cite xref">NIST-PQC</a>]</span>.
Namely, these are ML-KEM <span>[<a href="#FIPS-203" class="cite xref">FIPS-203</a>]</span> as a Key Encapsulation Mechanism (KEM), a KEM being a modern building block for public-key encryption, and ML-DSA <span>[<a href="#FIPS-204" class="cite xref">FIPS-204</a>]</span> as well as SLH-DSA-SHAKE <span>[<a href="#FIPS-205" class="cite xref">FIPS-205</a>]</span> as signature schemes.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">For the two ML-* schemes, this document follows the conservative strategy to deploy post-quantum in combination with traditional schemes such that the security is retained even if all schemes but one in the combination are broken.
In contrast, the stateless hash-based signature scheme SLH-DSA-SHAKE is considered to be sufficiently well understood with respect to its security assumptions in order to be used standalone.
To this end, this document specifies the following new set: SLH-DSA-SHAKE standalone and the two ML-* as composite with ECC-based KEM and digital signature schemes.
Here, the term "composite" indicates that any data structure or algorithm pertaining to the combination of the two components appears as single data structure or algorithm from the protocol perspective.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">The document specifies the conventions for interoperability between compliant OpenPGP implementations that make use of this extension and the newly defined algorithms or algorithm combinations.<a href="#section-1-4" class="pilcrow">¶</a></p>
<div id="conventions-used-in-this-document">
<section id="section-1.1">
        <h3 id="name-conventions-used-in-this-do">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-conventions-used-in-this-do" class="section-name selfRef">Conventions used in this Document</a>
        </h3>
<div id="terminology-for-multi-algorithm-schemes">
<section id="section-1.1.1">
          <h4 id="name-terminology-for-multi-algor">
<a href="#section-1.1.1" class="section-number selfRef">1.1.1. </a><a href="#name-terminology-for-multi-algor" class="section-name selfRef">Terminology for Multi-Algorithm Schemes</a>
          </h4>
<p id="section-1.1.1-1">The terminology in this document is oriented towards the definitions in <span>[<a href="#I-D.ietf-pquip-pqt-hybrid-terminology" class="cite xref">I-D.ietf-pquip-pqt-hybrid-terminology</a>]</span>.
Specifically, the terms "multi-algorithm", "composite" and "non-composite" are used in correspondence with the definitions therein.
The abbreviation "PQ" is used for post-quantum schemes.
To denote the combination of post-quantum and traditional schemes, the abbreviation "PQ/T" is used.
The short form "PQ(/T)" stands for PQ or PQ/T.<a href="#section-1.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="post-quantum-cryptography">
<section id="section-1.2">
        <h3 id="name-post-quantum-cryptography">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-post-quantum-cryptography" class="section-name selfRef">Post-Quantum Cryptography</a>
        </h3>
<p id="section-1.2-1">This section describes the individual post-quantum cryptographic schemes.
All schemes listed here are believed to provide security in the presence of a cryptographically relevant quantum computer.
However, the mathematical problems on which the two ML-* schemes and SLH-DSA-SHAKE are based, are fundamentally different, and accordingly the level of trust commonly placed in them as well as their performance characteristics vary.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">[Note to the reader: This specification refers to the NIST PQC draft standards FIPS 203, FIPS 204, and FIPS 205 as if they were a final specification.
This is a temporary solution until the final versions of these documents are available.
The goal is to provide a sufficiently precise specification of the algorithms already at the draft stage of this specification, so that it is possible for implementers to create interoperable implementations.
Furthermore, we want to point out that, depending on possible future changes to the draft standards by NIST, this specification may be updated as soon as corresponding information becomes available.]<a href="#section-1.2-2" class="pilcrow">¶</a></p>
<div id="mlkem-intro">
<section id="section-1.2.1">
          <h4 id="name-ml-kem">
<a href="#section-1.2.1" class="section-number selfRef">1.2.1. </a><a href="#name-ml-kem" class="section-name selfRef">ML-KEM</a>
          </h4>
<p id="section-1.2.1-1">ML-KEM <span>[<a href="#FIPS-203" class="cite xref">FIPS-203</a>]</span> is based on the hardness of solving the learning-with-errors problem in module lattices (MLWE).
The scheme is believed to provide security against cryptanalytic attacks by classical as well as quantum computers.
This specification defines ML-KEM only in composite combination with ECDH encryption schemes in order to provide a pre-quantum security fallback.<a href="#section-1.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="mldsa-intro">
<section id="section-1.2.2">
          <h4 id="name-ml-dsa">
<a href="#section-1.2.2" class="section-number selfRef">1.2.2. </a><a href="#name-ml-dsa" class="section-name selfRef">ML-DSA</a>
          </h4>
<p id="section-1.2.2-1">ML-DSA <span>[<a href="#FIPS-204" class="cite xref">FIPS-204</a>]</span> is a signature scheme that, like ML-KEM, is based on the hardness of solving the Learning With Errors problem and a variant of the Short Integer Solution problem in module lattices (MLWE and SelfTargetMSIS).
Accordingly, this specification only defines ML-DSA in composite combination with EdDSA signature schemes.<a href="#section-1.2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="slh-dsa-shake">
<section id="section-1.2.3">
          <h4 id="name-slh-dsa-shake">
<a href="#section-1.2.3" class="section-number selfRef">1.2.3. </a><a href="#name-slh-dsa-shake" class="section-name selfRef">SLH-DSA-SHAKE</a>
          </h4>
<p id="section-1.2.3-1">SLH-DSA-SHAKE <span>[<a href="#FIPS-205" class="cite xref">FIPS-205</a>]</span> is a stateless hash-based signature scheme.
Its security relies on the hardness of finding preimages for cryptographic hash functions.
This feature is generally considered to be a high security guarantee.
Therefore, this specification defines SLH-DSA-SHAKE as a standalone signature scheme.<a href="#section-1.2.3-1" class="pilcrow">¶</a></p>
<p id="section-1.2.3-2">In deployments the performance characteristics of SLH-DSA-SHAKE should be taken into account.
We refer to <a href="#performance-considerations" class="auto internal xref">Section 10.1</a> for a discussion of the performance characteristics of this scheme.<a href="#section-1.2.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="elliptic-curve-cryptography">
<section id="section-1.3">
        <h3 id="name-elliptic-curve-cryptography">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-elliptic-curve-cryptography" class="section-name selfRef">Elliptic Curve Cryptography</a>
        </h3>
<p id="section-1.3-1">The ECDH encryption is defined here as a KEM.
Curve25519 and Curve448 are defined in <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span> for use in a Diffie-Hellman key agreement scheme and defined in <span>[<a href="#RFC8032" class="cite xref">RFC8032</a>]</span> for use in a digital signature scheme.<a href="#section-1.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="multi-algo-schemes">
<section id="section-1.4">
        <h3 id="name-standalone-and-multi-algori">
<a href="#section-1.4" class="section-number selfRef">1.4. </a><a href="#name-standalone-and-multi-algori" class="section-name selfRef">Standalone and Multi-Algorithm Schemes</a>
        </h3>
<p id="section-1.4-1">This section provides a categorization of the new algorithms and their combinations.<a href="#section-1.4-1" class="pilcrow">¶</a></p>
<div id="composite-multi-alg">
<section id="section-1.4.1">
          <h4 id="name-standalone-and-composite-mu">
<a href="#section-1.4.1" class="section-number selfRef">1.4.1. </a><a href="#name-standalone-and-composite-mu" class="section-name selfRef">Standalone and Composite Multi-Algorithm Schemes</a>
          </h4>
<p id="section-1.4.1-1">This specification introduces new cryptographic schemes, which can be categorized as follows:<a href="#section-1.4.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.4.1-2.1">
              <p id="section-1.4.1-2.1.1">PQ/T multi-algorithm public-key encryption, namely a composite combination of ML-KEM with an ECDH KEM,<a href="#section-1.4.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.4.1-2.2">
              <p id="section-1.4.1-2.2.1">PQ/T multi-algorithm digital signature, namely composite combinations of ML-DSA with EdDSA signature schemes,<a href="#section-1.4.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.4.1-2.3">
              <p id="section-1.4.1-2.3.1">PQ digital signature, namely SLH-DSA-SHAKE as a standalone cryptographic algorithm.<a href="#section-1.4.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-1.4.1-3">For each of the composite schemes, this specification mandates that the recipient has to successfully perform the cryptographic algorithms for each of the component schemes used in a cryptographic message, in order for the message to be deciphered and considered as valid.
This means that all component signatures must be verified successfully in order to achieve a successful verification of the composite signature.
In the case of the composite public-key decryption, each of the component KEM decapsulation operations must succeed.<a href="#section-1.4.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="non-composite-multi-alg">
<section id="section-1.4.2">
          <h4 id="name-non-composite-algorithm-com">
<a href="#section-1.4.2" class="section-number selfRef">1.4.2. </a><a href="#name-non-composite-algorithm-com" class="section-name selfRef">Non-Composite Algorithm Combinations</a>
          </h4>
<p id="section-1.4.2-1">As the OpenPGP protocol <span>[<a href="#I-D.ietf-openpgp-crypto-refresh" class="cite xref">I-D.ietf-openpgp-crypto-refresh</a>]</span> allows for multiple signatures to be applied to a single message, it is also possible to realize non-composite combinations of signatures.
Furthermore, multiple OpenPGP signatures may be combined on the application layer.
These latter two cases realize non-composite combinations of signatures.
<a href="#multiple-signatures" class="auto internal xref">Section 3.4</a> specifies how implementations should handle the verification of such combinations of signatures.<a href="#section-1.4.2-1" class="pilcrow">¶</a></p>
<p id="section-1.4.2-2">Furthermore, the OpenPGP protocol also allows for parallel encryption to different keys held by the same recipient.
Accordingly, if the sender makes use of this feature and sends an encrypted message with multiple PKESK packages for different encryption keys held by the same recipient, a non-composite multi-algorithm public-key encryption is realized where the recipient has to decrypt only one of the PKESK packages in order to decrypt the message.
See <a href="#no-pq-t-parallel-encryption" class="auto internal xref">Section 3.2</a> for restrictions on parallel encryption mandated by this specification.<a href="#section-1.4.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="supported-public-key-algorithms">
<section id="section-2">
      <h2 id="name-supported-public-key-algori">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-supported-public-key-algori" class="section-name selfRef">Supported Public Key Algorithms</a>
      </h2>
<p id="section-2-1">This section specifies the composite ML-KEM + ECDH and ML-DSA + EdDSA schemes as well as the standalone SLH-DSA-SHAKE signature scheme.
All of these schemes are fully specified via their algorithm ID, i.e., they are not parametrized.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="algorithm-specifications">
<section id="section-2.1">
        <h3 id="name-algorithm-specifications">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-algorithm-specifications" class="section-name selfRef">Algorithm Specifications</a>
        </h3>
<p id="section-2.1-1">For encryption, the following composite KEM schemes are specified:<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<span id="name-kem-algorithm-specification"></span><div id="kem-alg-specs">
<table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-kem-algorithm-specification" class="selfRef">KEM algorithm specifications</a>
          </caption>
<thead>
            <tr>
              <th class="text-right" rowspan="1" colspan="1">ID</th>
              <th class="text-left" rowspan="1" colspan="1">Algorithm</th>
              <th class="text-left" rowspan="1" colspan="1">Requirement</th>
              <th class="text-left" rowspan="1" colspan="1">Definition</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">TBD (105 for testing)</td>
              <td class="text-left" rowspan="1" colspan="1">ML-KEM-768+X25519</td>
              <td class="text-left" rowspan="1" colspan="1">MUST</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#ecc-mlkem" class="auto internal xref">Section 4.2</a>
</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">TBD (106 for testing)</td>
              <td class="text-left" rowspan="1" colspan="1">ML-KEM-1024+X448</td>
              <td class="text-left" rowspan="1" colspan="1">SHOULD</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#ecc-mlkem" class="auto internal xref">Section 4.2</a>
</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-2.1-3">For signatures, the following (composite) signature schemes are specified:<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<span id="name-signature-algorithm-specifi"></span><div id="sig-alg-specs">
<table class="center" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-signature-algorithm-specifi" class="selfRef">Signature algorithm specifications</a>
          </caption>
<thead>
            <tr>
              <th class="text-right" rowspan="1" colspan="1">ID</th>
              <th class="text-left" rowspan="1" colspan="1">Algorithm</th>
              <th class="text-left" rowspan="1" colspan="1">Requirement</th>
              <th class="text-left" rowspan="1" colspan="1">Definition</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">TBD (107 for testing)</td>
              <td class="text-left" rowspan="1" colspan="1">ML-DSA-65+Ed25519</td>
              <td class="text-left" rowspan="1" colspan="1">MUST</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#ecc-mldsa" class="auto internal xref">Section 5.2</a>
</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">TBD (108 for testing)</td>
              <td class="text-left" rowspan="1" colspan="1">ML-DSA-87+Ed448</td>
              <td class="text-left" rowspan="1" colspan="1">SHOULD</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#ecc-mldsa" class="auto internal xref">Section 5.2</a>
</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">TBD</td>
              <td class="text-left" rowspan="1" colspan="1">SLH-DSA-SHAKE-128s</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#slhdsa" class="auto internal xref">Section 6.1</a>
</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">TBD</td>
              <td class="text-left" rowspan="1" colspan="1">SLH-DSA-SHAKE-128f</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#slhdsa" class="auto internal xref">Section 6.1</a>
</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">TBD</td>
              <td class="text-left" rowspan="1" colspan="1">SLH-DSA-SHAKE-256s</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#slhdsa" class="auto internal xref">Section 6.1</a>
</td>
            </tr>
          </tbody>
        </table>
</div>
<div id="experimental-codepoints-for-interop-testing">
<section id="section-2.1.1">
          <h4 id="name-experimental-codepoints-for">
<a href="#section-2.1.1" class="section-number selfRef">2.1.1. </a><a href="#name-experimental-codepoints-for" class="section-name selfRef">Experimental Codepoints for Interop Testing</a>
          </h4>
<p id="section-2.1.1-1">[ Note: this section to be removed before publication ]<a href="#section-2.1.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1.1-2">Algorithms indicated as MAY are not assigned a codepoint in the current state of the draft in order to leave enough private/experimental code points available for other drafts.<a href="#section-2.1.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1.1-3">The use of private/experimental codepoints during development are intended to be used in non-released software only, for experimentation and interop testing purposes only.
An OpenPGP implementation MUST NOT produce a formal release using these experimental codepoints.
This draft will not be sent to IANA without every listed algorithm having a non-experimental codepoint.<a href="#section-2.1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="algorithm-combinations">
<section id="section-3">
      <h2 id="name-algorithm-combinations">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-algorithm-combinations" class="section-name selfRef">Algorithm Combinations</a>
      </h2>
<div id="composite-kems">
<section id="section-3.1">
        <h3 id="name-composite-kems">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-composite-kems" class="section-name selfRef">Composite KEMs</a>
        </h3>
<p id="section-3.1-1">The ML-KEM + ECDH public-key encryption involves both the ML-KEM and an ECDH KEM in an a priori non-separable manner.
This is achieved via KEM combination, i.e. both key encapsulations/decapsulations are performed in parallel, and the resulting key shares are fed into a key combiner to produce a single shared secret for message encryption.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="no-pq-t-parallel-encryption">
<section id="section-3.2">
        <h3 id="name-parallel-public-key-encrypt">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-parallel-public-key-encrypt" class="section-name selfRef">Parallel Public-Key Encryption</a>
        </h3>
<p id="section-3.2-1">As explained in <a href="#non-composite-multi-alg" class="auto internal xref">Section 1.4.2</a>, the OpenPGP protocol inherently supports parallel encryption to different keys of the same recipient.
Implementations MUST NOT encrypt a message with a purely traditional public-key encryption key of a recipient if it is encrypted with a PQ/T key of the same recipient.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="composite-signatures">
<section id="section-3.3">
        <h3 id="name-composite-signatures">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-composite-signatures" class="section-name selfRef">Composite Signatures</a>
        </h3>
<p id="section-3.3-1">The ML-DSA + EdDSA signature consists of independent ML-DSA and EdDSA signatures, and an implementation MUST successfully validate both signatures to state that the ML-DSA + EdDSA signature is valid.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="multiple-signatures">
<section id="section-3.4">
        <h3 id="name-multiple-signatures">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-multiple-signatures" class="section-name selfRef">Multiple Signatures</a>
        </h3>
<p id="section-3.4-1">The OpenPGP message format allows multiple signatures of a message, i.e. the attachment of multiple signature packets.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">An implementation MAY sign a message with a traditional key and a PQ(/T) key from the same sender.
This ensures backwards compatibility due to <span>[<a href="#I-D.ietf-openpgp-crypto-refresh" class="cite xref">I-D.ietf-openpgp-crypto-refresh</a>]</span>, Section 5.2.5, since a legacy implementation without PQ(/T) support can fall back on the traditional signature.<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<p id="section-3.4-3">Newer implementations with PQ(/T) support MAY ignore the traditional signature(s) during validation.<a href="#section-3.4-3" class="pilcrow">¶</a></p>
<p id="section-3.4-4">Implementations SHOULD consider the message correctly signed if at least one of the non-ignored signatures validates successfully.<a href="#section-3.4-4" class="pilcrow">¶</a></p>
<p id="section-3.4-5">[Note to the reader: The last requirement, that one valid signature is sufficient to identify a message as correctly signed, is an interpretation of <span>[<a href="#I-D.ietf-openpgp-crypto-refresh" class="cite xref">I-D.ietf-openpgp-crypto-refresh</a>]</span>, Section 5.2.5.]<a href="#section-3.4-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ecc-requirements">
<section id="section-3.5">
        <h3 id="name-ecc-requirements">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-ecc-requirements" class="section-name selfRef">ECC requirements</a>
        </h3>
<p id="section-3.5-1">Even though the zero point, also called the point at infinity, may occur as a result of arithmetic operations on points of an elliptic curve, it MUST NOT appear in any ECC data structure defined in this document.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<p id="section-3.5-2">Furthermore, when performing the explicitly listed operations in <a href="#x25519-kem" class="auto internal xref">Section 4.1.1.1</a> or <a href="#x448-kem" class="auto internal xref">Section 4.1.1.2</a> it is REQUIRED to follow the specification and security advisory mandated from the respective elliptic curve specification.<a href="#section-3.5-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="composite-kem-schemes">
<section id="section-4">
      <h2 id="name-composite-kem-schemes">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-composite-kem-schemes" class="section-name selfRef">Composite KEM schemes</a>
      </h2>
<div id="building-blocks">
<section id="section-4.1">
        <h3 id="name-building-blocks">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-building-blocks" class="section-name selfRef">Building Blocks</a>
        </h3>
<div id="ecc-kem">
<section id="section-4.1.1">
          <h4 id="name-ecdh-kems">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-ecdh-kems" class="section-name selfRef">ECDH KEMs</a>
          </h4>
<p id="section-4.1.1-1">In this section we define the encryption, decryption, and data formats for the ECDH component of the composite algorithms.<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1.1-2"><a href="#tab-ecdh-cfrg-artifacts" class="auto internal xref">Table 3</a> describes the ECDH-KEM parameters and artifact lengths.
The artifacts in <a href="#tab-ecdh-cfrg-artifacts" class="auto internal xref">Table 3</a> follow the encodings described in <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>.<a href="#section-4.1.1-2" class="pilcrow">¶</a></p>
<span id="name-montgomery-curves-parameter"></span><div id="tab-ecdh-cfrg-artifacts">
<table class="center" id="table-3">
            <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-montgomery-curves-parameter" class="selfRef">Montgomery curves parameters and artifact lengths</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1"> </th>
                <th class="text-left" rowspan="1" colspan="1">X25519</th>
                <th class="text-left" rowspan="1" colspan="1">X448</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Algorithm ID reference</td>
                <td class="text-left" rowspan="1" colspan="1">TBD (105 for testing)</td>
                <td class="text-left" rowspan="1" colspan="1">TBD (106 for testing)</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Field size</td>
                <td class="text-left" rowspan="1" colspan="1">32 octets</td>
                <td class="text-left" rowspan="1" colspan="1">56 octets</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">ECDH-KEM</td>
                <td class="text-left" rowspan="1" colspan="1">x25519Kem (<a href="#x25519-kem" class="auto internal xref">Section 4.1.1.1</a>)</td>
                <td class="text-left" rowspan="1" colspan="1">x448Kem (<a href="#x448-kem" class="auto internal xref">Section 4.1.1.2</a>)</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">ECDH public key</td>
                <td class="text-left" rowspan="1" colspan="1">32 octets <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>
</td>
                <td class="text-left" rowspan="1" colspan="1">56 octets <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">ECDH secret key</td>
                <td class="text-left" rowspan="1" colspan="1">32 octets <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>
</td>
                <td class="text-left" rowspan="1" colspan="1">56 octets <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">ECDH ephemeral</td>
                <td class="text-left" rowspan="1" colspan="1">32 octets <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>
</td>
                <td class="text-left" rowspan="1" colspan="1">56 octets <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">ECDH share</td>
                <td class="text-left" rowspan="1" colspan="1">32 octets <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>
</td>
                <td class="text-left" rowspan="1" colspan="1">56 octets <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Key share</td>
                <td class="text-left" rowspan="1" colspan="1">32 octets</td>
                <td class="text-left" rowspan="1" colspan="1">64 octets</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Hash</td>
                <td class="text-left" rowspan="1" colspan="1">SHA3-256</td>
                <td class="text-left" rowspan="1" colspan="1">SHA3-512</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-4.1.1-4">The various procedures to perform the operations of an ECDH KEM are defined in the following subsections.
Specifically, each of these subsections defines the instances of the following operations:<a href="#section-4.1.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.1-5">
<pre>
(ecdhCipherText, ecdhKeyShare) &lt;- ECDH-KEM.Encaps(ecdhPublicKey)
</pre><a href="#section-4.1.1-5" class="pilcrow">¶</a>
</div>
<p id="section-4.1.1-6">and<a href="#section-4.1.1-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.1-7">
<pre>
(ecdhKeyShare) &lt;- ECDH-KEM.Decaps(ecdhSecretKey, ecdhCipherText, ecdhPublicKey)
</pre><a href="#section-4.1.1-7" class="pilcrow">¶</a>
</div>
<p id="section-4.1.1-8">To instantiate <code>ECDH-KEM</code>, one must select a parameter set from <a href="#tab-ecdh-cfrg-artifacts" class="auto internal xref">Table 3</a>.<a href="#section-4.1.1-8" class="pilcrow">¶</a></p>
<div id="x25519-kem">
<section id="section-4.1.1.1">
            <h5 id="name-x25519-kem">
<a href="#section-4.1.1.1" class="section-number selfRef">4.1.1.1. </a><a href="#name-x25519-kem" class="section-name selfRef">X25519-KEM</a>
            </h5>
<p id="section-4.1.1.1-1">The encapsulation and decapsulation operations of <code>x25519kem</code> are described using the function <code>X25519()</code> and encodings defined in <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>.
The <code>ecdhSecretKey</code> is denoted as <code>r</code>, the <code>ecdhPublicKey</code> as <code>R</code>, they are subject to the equation <code>R = X25519(r, U(P))</code>.
Here, <code>U(P)</code> denotes the u-coordinate of the base point of Curve25519.<a href="#section-4.1.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1.1.1-2">The operation <code>x25519Kem.Encaps()</code> is defined as follows:<a href="#section-4.1.1.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.1.1.1-3">
<li id="section-4.1.1.1-3.1">
                <p id="section-4.1.1.1-3.1.1">Generate an ephemeral key pair {<code>v</code>, <code>V</code>} via <code>V = X25519(v,U(P))</code> where <code>v</code> is a randomly generated octet string with a length of 32 octets<a href="#section-4.1.1.1-3.1.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-4.1.1.1-3.2">
                <p id="section-4.1.1.1-3.2.1">Compute the shared coordinate <code>X = X25519(v, R)</code> where <code>R</code> is the recipient's public key <code>ecdhPublicKey</code><a href="#section-4.1.1.1-3.2.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-4.1.1.1-3.3">
                <p id="section-4.1.1.1-3.3.1">Set the output <code>ecdhCipherText</code> to <code>V</code><a href="#section-4.1.1.1-3.3.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-4.1.1.1-3.4">
                <p id="section-4.1.1.1-3.4.1">Set the output <code>ecdhKeyShare</code> to <code>SHA3-256(X || ecdhCipherText || ecdhPublicKey)</code><a href="#section-4.1.1.1-3.4.1" class="pilcrow">¶</a></p>
</li>
            </ol>
<p id="section-4.1.1.1-4">The operation <code>x25519Kem.Decaps()</code> is defined as follows:<a href="#section-4.1.1.1-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.1.1.1-5">
<li id="section-4.1.1.1-5.1">
                <p id="section-4.1.1.1-5.1.1">Compute the shared coordinate <code>X = X25519(r, V)</code>, where <code>r</code> is the <code>ecdhSecretKey</code> and <code>V</code> is the <code>ecdhCipherText</code><a href="#section-4.1.1.1-5.1.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-4.1.1.1-5.2">
                <p id="section-4.1.1.1-5.2.1">Set the output <code>ecdhKeyShare</code> to <code>SHA3-256(X || ecdhCipherText || ecdhPublicKey)</code><a href="#section-4.1.1.1-5.2.1" class="pilcrow">¶</a></p>
</li>
            </ol>
</section>
</div>
<div id="x448-kem">
<section id="section-4.1.1.2">
            <h5 id="name-x448-kem">
<a href="#section-4.1.1.2" class="section-number selfRef">4.1.1.2. </a><a href="#name-x448-kem" class="section-name selfRef">X448-KEM</a>
            </h5>
<p id="section-4.1.1.2-1">The encapsulation and decapsulation operations of <code>x448kem</code> are described using the function <code>X448()</code> and encodings defined in <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>.
The <code>ecdhSecretKey</code> is denoted as <code>r</code>, the <code>ecdhPublicKey</code> as <code>R</code>, they are subject to the equation <code>R = X25519(r, U(P))</code>.
Here, <code>U(P)</code> denotes the u-coordinate of the base point of Curve448.<a href="#section-4.1.1.2-1" class="pilcrow">¶</a></p>
<p id="section-4.1.1.2-2">The operation <code>x448.Encaps()</code> is defined as follows:<a href="#section-4.1.1.2-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.1.1.2-3">
<li id="section-4.1.1.2-3.1">
                <p id="section-4.1.1.2-3.1.1">Generate an ephemeral key pair {<code>v</code>, <code>V</code>} via <code>V = X448(v,U(P))</code> where <code>v</code> is a randomly generated octet string with a length of 56 octets<a href="#section-4.1.1.2-3.1.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-4.1.1.2-3.2">
                <p id="section-4.1.1.2-3.2.1">Compute the shared coordinate <code>X = X448(v, R)</code> where <code>R</code> is the recipient's public key <code>ecdhPublicKey</code><a href="#section-4.1.1.2-3.2.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-4.1.1.2-3.3">
                <p id="section-4.1.1.2-3.3.1">Set the output <code>ecdhCipherText</code> to <code>V</code><a href="#section-4.1.1.2-3.3.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-4.1.1.2-3.4">
                <p id="section-4.1.1.2-3.4.1">Set the output <code>ecdhKeyShare</code> to <code>SHA3-512(X || ecdhCipherText || ecdhPublicKey)</code><a href="#section-4.1.1.2-3.4.1" class="pilcrow">¶</a></p>
</li>
            </ol>
<p id="section-4.1.1.2-4">The operation <code>x448Kem.Decaps()</code> is defined as follows:<a href="#section-4.1.1.2-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.1.1.2-5">
<li id="section-4.1.1.2-5.1">
                <p id="section-4.1.1.2-5.1.1">Compute the shared coordinate <code>X = X448(r, V)</code>, where <code>r</code> is the <code>ecdhSecretKey</code> and <code>V</code> is the <code>ecdhCipherText</code><a href="#section-4.1.1.2-5.1.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-4.1.1.2-5.2">
                <p id="section-4.1.1.2-5.2.1">Set the output <code>ecdhKeyShare</code> to <code>SHA3-512(X || ecdhCipherText || ecdhPublicKey)</code><a href="#section-4.1.1.2-5.2.1" class="pilcrow">¶</a></p>
</li>
            </ol>
</section>
</div>
</section>
</div>
<div id="mlkem-ops">
<section id="section-4.1.2">
          <h4 id="name-ml-kem-2">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-ml-kem-2" class="section-name selfRef">ML-KEM</a>
          </h4>
<p id="section-4.1.2-1">ML-KEM features the following operations:<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.2-2">
<pre>
(mlkemCipherText, mlkemKeyShare) &lt;- ML-KEM.Encaps(mlkemPublicKey)
</pre><a href="#section-4.1.2-2" class="pilcrow">¶</a>
</div>
<p id="section-4.1.2-3">and<a href="#section-4.1.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.2-4">
<pre>
(mlkemKeyShare) &lt;- ML-KEM.Decaps(mlkemCipherText, mlkemSecretKey)
</pre><a href="#section-4.1.2-4" class="pilcrow">¶</a>
</div>
<p id="section-4.1.2-5">The above are the operations <code>ML-KEM.Encaps</code> and <code>ML-KEM.Decaps</code> defined in <span>[<a href="#FIPS-203" class="cite xref">FIPS-203</a>]</span>.
Note that <code>mlkemPublicKey</code> is the encapsulation and <code>mlkemSecretKey</code> is the decapsulation key.<a href="#section-4.1.2-5" class="pilcrow">¶</a></p>
<p id="section-4.1.2-6">ML-KEM has the parametrization with the corresponding artifact lengths in octets as given in <a href="#tab-mlkem-artifacts" class="auto internal xref">Table 4</a>.
All artifacts are encoded as defined in <span>[<a href="#FIPS-203" class="cite xref">FIPS-203</a>]</span>.<a href="#section-4.1.2-6" class="pilcrow">¶</a></p>
<span id="name-ml-kem-parameters-artifact-"></span><div id="tab-mlkem-artifacts">
<table class="center" id="table-4">
            <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-ml-kem-parameters-artifact-" class="selfRef">ML-KEM parameters artifact lengths in octets</a>
            </caption>
<thead>
              <tr>
                <th class="text-right" rowspan="1" colspan="1">Algorithm ID reference</th>
                <th class="text-left" rowspan="1" colspan="1">ML-KEM</th>
                <th class="text-left" rowspan="1" colspan="1">Public key</th>
                <th class="text-left" rowspan="1" colspan="1">Secret key</th>
                <th class="text-left" rowspan="1" colspan="1">Ciphertext</th>
                <th class="text-left" rowspan="1" colspan="1">Key share</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">TBD (105 for testing)</td>
                <td class="text-left" rowspan="1" colspan="1">ML-KEM-768</td>
                <td class="text-left" rowspan="1" colspan="1">1184</td>
                <td class="text-left" rowspan="1" colspan="1">2400</td>
                <td class="text-left" rowspan="1" colspan="1">1088</td>
                <td class="text-left" rowspan="1" colspan="1">32</td>
              </tr>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">TBD (106 for testing)</td>
                <td class="text-left" rowspan="1" colspan="1">ML-KEM-1024</td>
                <td class="text-left" rowspan="1" colspan="1">1568</td>
                <td class="text-left" rowspan="1" colspan="1">3168</td>
                <td class="text-left" rowspan="1" colspan="1">1568</td>
                <td class="text-left" rowspan="1" colspan="1">32</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-4.1.2-8">To instantiate <code>ML-KEM</code>, one must select a parameter set from the column "ML-KEM" of <a href="#tab-mlkem-artifacts" class="auto internal xref">Table 4</a>.<a href="#section-4.1.2-8" class="pilcrow">¶</a></p>
<p id="section-4.1.2-9">The procedure to perform <code>ML-KEM.Encaps()</code> is as follows:<a href="#section-4.1.2-9" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.1.2-10">
<li id="section-4.1.2-10.1">
              <p id="section-4.1.2-10.1.1">Invoke <code>(mlkemCipherText, mlkemKeyShare) &lt;- ML-KEM.Encaps(mlkemPublicKey)</code>, where <code>mlkemPublicKey</code> is the recipient's public key<a href="#section-4.1.2-10.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.1.2-10.2">
              <p id="section-4.1.2-10.2.1">Set <code>mlkemCipherText</code> as the ML-KEM ciphertext<a href="#section-4.1.2-10.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.1.2-10.3">
              <p id="section-4.1.2-10.3.1">Set <code>mlkemKeyShare</code> as the ML-KEM symmetric key share<a href="#section-4.1.2-10.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-4.1.2-11">The procedure to perform <code>ML-KEM.Decaps()</code> is as follows:<a href="#section-4.1.2-11" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.1.2-12">
<li id="section-4.1.2-12.1">
              <p id="section-4.1.2-12.1.1">Invoke <code>mlkemKeyShare &lt;-  ML-KEM.Decaps(mlkemCipherText, mlkemSecretKey)</code><a href="#section-4.1.2-12.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.1.2-12.2">
              <p id="section-4.1.2-12.2.1">Set <code>mlkemKeyShare</code> as the ML-KEM symmetric key share<a href="#section-4.1.2-12.2.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
</section>
</div>
<div id="ecc-mlkem">
<section id="section-4.2">
        <h3 id="name-composite-encryption-scheme">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-composite-encryption-scheme" class="section-name selfRef">Composite Encryption Schemes with ML-KEM</a>
        </h3>
<p id="section-4.2-1"><a href="#kem-alg-specs" class="auto internal xref">Table 1</a> specifies the following ML-KEM + ECDH composite public-key encryption schemes:<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<span id="name-ml-kem-ecdh-composite-schem"></span><div id="tab-mlkem-ecc-composite">
<table class="center" id="table-5">
          <caption>
<a href="#table-5" class="selfRef">Table 5</a>:
<a href="#name-ml-kem-ecdh-composite-schem" class="selfRef">ML-KEM + ECDH composite schemes</a>
          </caption>
<thead>
            <tr>
              <th class="text-right" rowspan="1" colspan="1">Algorithm ID reference</th>
              <th class="text-left" rowspan="1" colspan="1">ML-KEM</th>
              <th class="text-left" rowspan="1" colspan="1">ECDH-KEM</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">TBD (105 for testing)</td>
              <td class="text-left" rowspan="1" colspan="1">ML-KEM-768</td>
              <td class="text-left" rowspan="1" colspan="1">x25519Kem</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">TBD (106 for testing)</td>
              <td class="text-left" rowspan="1" colspan="1">ML-KEM-1024</td>
              <td class="text-left" rowspan="1" colspan="1">x448Kem</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-4.2-3">The ML-KEM + ECDH composite public-key encryption schemes are built according to the following principal design:<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-4.1">
            <p id="section-4.2-4.1.1">The ML-KEM encapsulation algorithm is invoked to create an ML-KEM ciphertext together with an ML-KEM symmetric key share.<a href="#section-4.2-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-4.2">
            <p id="section-4.2-4.2.1">The encapsulation algorithm of an ECDH KEM, namely X25519-KEM or X448-KEM, is invoked to create an ECDH ciphertext together with an ECDH symmetric key share.<a href="#section-4.2-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-4.3">
            <p id="section-4.2-4.3.1">A Key-Encryption-Key (KEK) is computed as the output of a key combiner that receives as input both of the above created symmetric key shares and the protocol binding information.<a href="#section-4.2-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-4.4">
            <p id="section-4.2-4.4.1">The session key for content encryption is then wrapped as described in <span>[<a href="#RFC3394" class="cite xref">RFC3394</a>]</span> using AES-256 as algorithm and the KEK as key.<a href="#section-4.2-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-4.5">
            <p id="section-4.2-4.5.1">The PKESK package's algorithm-specific parts are made up of the ML-KEM ciphertext, the ECDH ciphertext, and the wrapped session key.<a href="#section-4.2-4.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div id="kem-fixed-info">
<section id="section-4.2.1">
          <h4 id="name-fixed-information">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-fixed-information" class="section-name selfRef">Fixed information</a>
          </h4>
<p id="section-4.2.1-1">For the composite KEM schemes defined in <a href="#kem-alg-specs" class="auto internal xref">Table 1</a> the following procedure, justified in <a href="#sec-fixed-info" class="auto internal xref">Section 9.4</a>, MUST be used to derive a string to use as binding between the KEK and the communication parties.<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.1-2">
<pre>
//   Input:
//   algID - the algorithm ID encoded as octet
//
//   Constants:
//   domSeparation - the UTF-8 encoding of the string
//                   "OpenPGPCompositeKDFv1"

fixedInfo = algID || domSeparation
</pre><a href="#section-4.2.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.2.1-3">The value of <code>domSeparation</code> is the UTF-8 encoding of the string "OpenPGPCompositeKDFv1" and MUST be the following octet sequence:<a href="#section-4.2.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.1-4">
<pre>
domSeparation := 4F 70 65 6E 50 47 50 43 6F 6D 70 6F 73 69 74 65 4B
                 44 46 76 31
</pre><a href="#section-4.2.1-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="kem-key-combiner">
<section id="section-4.2.2">
          <h4 id="name-key-combiner">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-key-combiner" class="section-name selfRef">Key combiner</a>
          </h4>
<p id="section-4.2.2-1">For the composite KEM schemes defined in <a href="#kem-alg-specs" class="auto internal xref">Table 1</a> the following procedure MUST be used to compute the KEK that wraps a session key.
The construction is a one-step key derivation function compliant to <span>[<a href="#SP800-56C" class="cite xref">SP800-56C</a>]</span>, Section 4, based on SHA3-256.
It is given by the following algorithm, which computes the key encryption key <code>KEK</code> that is used to wrap, i.e., encrypt, the session key.<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.2-2">
<pre>
//   multiKeyCombine(ecdhKeyShare, ecdhCipherText, ecdhPublicKey, mlkemKeyShare,
//                   mlkemCipherText, mlkemPublicKey, fixedInfo)
//
//   Input:
//   ecdhKeyShare    - the ECDH key share encoded as an octet string
//   ecdhCipherText  - the ECDH ciphertext encoded as an octet string
//   ecdhPublicKey   - The ECDH public key of the recipient as an octet string
//   mlkemKeyShare   - the ML-KEM key share encoded as an octet string
//   mlkemCipherText - the ML-KEM ciphertext encoded as an octet string
//   mlkemPublicKey  - The ML-KEM public key of the recipient as an octet string
//   fixedInfo       - the fixed information octet string
//
//   Constants:
//   counter - the 4 byte value 00 00 00 01

ecdhData = ecdhKeyShare || ecdhCipherText || ecdhPublicKey
mlkemData = mlkemKeyShare || mlkemCipherText || mlkemPublicKey

KEK = SHA3-256(counter || ecdhData || mlkemData || fixedInfo)
return KEK
</pre><a href="#section-4.2.2-2" class="pilcrow">¶</a>
</div>
<p id="section-4.2.2-3">Note that the values <code>ecdhKeyShare</code> defined in <a href="#ecc-kem" class="auto internal xref">Section 4.1.1</a> and <code>mlkemKeyShare</code> defined in <a href="#mlkem-ops" class="auto internal xref">Section 4.1.2</a> already use the relative ciphertext in the derivation.
The ciphertext and public keys are by design included again in the key combiner to provide a robust security proof.<a href="#section-4.2.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2.2-4">The value of <code>counter</code> MUST be set to the following octet sequence:<a href="#section-4.2.2-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.2-5">
<pre>
counter :=  00 00 00 01
</pre><a href="#section-4.2.2-5" class="pilcrow">¶</a>
</div>
<p id="section-4.2.2-6">The value of <code>fixedInfo</code> MUST be set according to <a href="#kem-fixed-info" class="auto internal xref">Section 4.2.1</a>.<a href="#section-4.2.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ecc-mlkem-generation">
<section id="section-4.2.3">
          <h4 id="name-key-generation-procedure">
<a href="#section-4.2.3" class="section-number selfRef">4.2.3. </a><a href="#name-key-generation-procedure" class="section-name selfRef">Key generation procedure</a>
          </h4>
<p id="section-4.2.3-1">The implementation MUST independently generate the ML-KEM and the ECDH component keys.
ML-KEM key generation follows the specification <span>[<a href="#FIPS-203" class="cite xref">FIPS-203</a>]</span> and the artifacts are encoded as fixed-length octet strings as defined in <a href="#mlkem-ops" class="auto internal xref">Section 4.1.2</a>.
For ECDH this is done following the relative specification in <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>, and encoding the outputs as fixed-length octet strings in the format specified in <a href="#tab-ecdh-cfrg-artifacts" class="auto internal xref">Table 3</a>.<a href="#section-4.2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ecc-mlkem-encryption">
<section id="section-4.2.4">
          <h4 id="name-encryption-procedure">
<a href="#section-4.2.4" class="section-number selfRef">4.2.4. </a><a href="#name-encryption-procedure" class="section-name selfRef">Encryption procedure</a>
          </h4>
<p id="section-4.2.4-1">The procedure to perform public-key encryption with an ML-KEM + ECDH composite scheme is as follows:<a href="#section-4.2.4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.2.4-2">
<li id="section-4.2.4-2.1">
              <p id="section-4.2.4-2.1.1">Take the recipient's authenticated public-key packet <code>pkComposite</code> and <code>sessionKey</code> as input<a href="#section-4.2.4-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.2.4-2.2">
              <p id="section-4.2.4-2.2.1">Parse the algorithm ID from <code>pkComposite</code><a href="#section-4.2.4-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.2.4-2.3">
              <p id="section-4.2.4-2.3.1">Extract the <code>ecdhPublicKey</code> and <code>mlkemPublicKey</code> component from the algorithm specific data encoded in <code>pkComposite</code> with the format specified in <a href="#mlkem-ecc-key" class="auto internal xref">Section 4.3.2</a>.<a href="#section-4.2.4-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.2.4-2.4">
              <p id="section-4.2.4-2.4.1">Instantiate the ECDH-KEM and the ML-KEM depending on the algorithm ID according to <a href="#tab-mlkem-ecc-composite" class="auto internal xref">Table 5</a><a href="#section-4.2.4-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.2.4-2.5">
              <p id="section-4.2.4-2.5.1">Compute <code>(ecdhCipherText, ecdhKeyShare) := ECDH-KEM.Encaps(ecdhPublicKey)</code><a href="#section-4.2.4-2.5.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.2.4-2.6">
              <p id="section-4.2.4-2.6.1">Compute <code>(mlkemCipherText, mlkemKeyShare) := ML-KEM.Encaps(mlkemPublicKey)</code><a href="#section-4.2.4-2.6.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.2.4-2.7">
              <p id="section-4.2.4-2.7.1">Compute <code>fixedInfo</code> as specified in <a href="#kem-fixed-info" class="auto internal xref">Section 4.2.1</a><a href="#section-4.2.4-2.7.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.2.4-2.8">
              <p id="section-4.2.4-2.8.1">Compute <code>KEK := multiKeyCombine(ecdhKeyShare, ecdhCipherText, ecdhPublicKey, mlkemKeyShare, mlkemCipherText, mlkemPublicKey, fixedInfo)</code> as defined in <a href="#kem-key-combiner" class="auto internal xref">Section 4.2.2</a><a href="#section-4.2.4-2.8.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.2.4-2.9">
              <p id="section-4.2.4-2.9.1">Compute <code>C := AESKeyWrap(KEK, sessionKey)</code> with AES-256 as per <span>[<a href="#RFC3394" class="cite xref">RFC3394</a>]</span> that includes a 64 bit integrity check<a href="#section-4.2.4-2.9.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.2.4-2.10">
              <p id="section-4.2.4-2.10.1">Output the algorithm specific part of the PKESK as <code>ecdhCipherText || mlkemCipherText || len(C, symAlgId) (|| symAlgId)  || C</code>, where both <code>symAlgId</code> and <code>len(C, symAlgId)</code> are single octet fields, <code>symAlgId</code> denotes the symmetric algorithm ID used and is present only for a v3 PKESK, and <code>len(C, symAlgId)</code> denotes the combined octet length of the fields specified as the arguments.<a href="#section-4.2.4-2.10.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
<div id="decryption-procedure">
<section id="section-4.2.5">
          <h4 id="name-decryption-procedure">
<a href="#section-4.2.5" class="section-number selfRef">4.2.5. </a><a href="#name-decryption-procedure" class="section-name selfRef">Decryption procedure</a>
          </h4>
<p id="section-4.2.5-1">The procedure to perform public-key decryption with an ML-KEM + ECDH composite scheme is as follows:<a href="#section-4.2.5-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.2.5-2">
<li id="section-4.2.5-2.1">
              <p id="section-4.2.5-2.1.1">Take the matching PKESK and own secret key packet as input<a href="#section-4.2.5-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.2.5-2.2">
              <p id="section-4.2.5-2.2.1">From the PKESK extract the algorithm ID and the <code>encryptedKey</code>, i.e., the wrapped session key<a href="#section-4.2.5-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.2.5-2.3">
              <p id="section-4.2.5-2.3.1">Check that the own and the extracted algorithm ID match<a href="#section-4.2.5-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.2.5-2.4">
              <p id="section-4.2.5-2.4.1">Parse the <code>ecdhSecretKey</code> and <code>mlkemSecretKey</code> from the algorithm specific data of the own secret key encoded in the format specified in <a href="#mlkem-ecc-key" class="auto internal xref">Section 4.3.2</a><a href="#section-4.2.5-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.2.5-2.5">
              <p id="section-4.2.5-2.5.1">Instantiate the ECDH-KEM and the ML-KEM depending on the algorithm ID according to <a href="#tab-mlkem-ecc-composite" class="auto internal xref">Table 5</a><a href="#section-4.2.5-2.5.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.2.5-2.6">
              <p id="section-4.2.5-2.6.1">Parse <code>ecdhCipherText</code>, <code>mlkemCipherText</code>, and <code>C</code> from <code>encryptedKey</code> encoded as <code>ecdhCipherText || mlkemCipherText || len(C,symAlgId) (|| symAlgId) || C</code> as specified in <a href="#ecc-mlkem-pkesk" class="auto internal xref">Section 4.3.1</a>, where <code>symAlgId</code> is present only in the case of a v3 PKESK.<a href="#section-4.2.5-2.6.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.2.5-2.7">
              <p id="section-4.2.5-2.7.1">Compute <code>(ecdhKeyShare) := ECDH-KEM.Decaps(ecdhCipherText, ecdhSecretKey, ecdhPublicKey)</code><a href="#section-4.2.5-2.7.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.2.5-2.8">
              <p id="section-4.2.5-2.8.1">Compute <code>(mlkemKeyShare) := ML-KEM.Decaps(mlkemCipherText, mlkemSecretKey)</code><a href="#section-4.2.5-2.8.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.2.5-2.9">
              <p id="section-4.2.5-2.9.1">Compute <code>fixedInfo</code> as specified in <a href="#kem-fixed-info" class="auto internal xref">Section 4.2.1</a><a href="#section-4.2.5-2.9.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.2.5-2.10">
              <p id="section-4.2.5-2.10.1">Compute <code>KEK := multiKeyCombine(ecdhKeyShare, ecdhCipherText, ecdhPublicKey, mlkemKeyShare, mlkemCipherText, mlkemPublicKey, fixedInfo)</code> as defined in <a href="#kem-key-combiner" class="auto internal xref">Section 4.2.2</a><a href="#section-4.2.5-2.10.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.2.5-2.11">
              <p id="section-4.2.5-2.11.1">Compute <code>sessionKey := AESKeyUnwrap(KEK, C)</code>  with AES-256 as per <span>[<a href="#RFC3394" class="cite xref">RFC3394</a>]</span>, aborting if the 64 bit integrity check fails<a href="#section-4.2.5-2.11.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.2.5-2.12">
              <p id="section-4.2.5-2.12.1">Output <code>sessionKey</code><a href="#section-4.2.5-2.12.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
</section>
</div>
<div id="packet-specifications">
<section id="section-4.3">
        <h3 id="name-packet-specifications">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-packet-specifications" class="section-name selfRef">Packet specifications</a>
        </h3>
<div id="ecc-mlkem-pkesk">
<section id="section-4.3.1">
          <h4 id="name-public-key-encrypted-sessio">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-public-key-encrypted-sessio" class="section-name selfRef">Public-Key Encrypted Session Key Packets (Tag 1)</a>
          </h4>
<p id="section-4.3.1-1">The algorithm-specific fields consists of the output of the encryption procedure described in <a href="#ecc-mlkem-encryption" class="auto internal xref">Section 4.2.4</a>:<a href="#section-4.3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1-2.1">
              <p id="section-4.3.1-2.1.1">A fixed-length octet string representing an ECDH ephemeral public key in the format associated with the curve as specified in <a href="#ecc-kem" class="auto internal xref">Section 4.1.1</a>.<a href="#section-4.3.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.3.1-2.2">
              <p id="section-4.3.1-2.2.1">A fixed-length octet string of the ML-KEM ciphertext, whose length depends on the algorithm ID as specified in <a href="#tab-mlkem-artifacts" class="auto internal xref">Table 4</a>.<a href="#section-4.3.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.3.1-2.3">
              <p id="section-4.3.1-2.3.1">A one-octet size of the following fields.<a href="#section-4.3.1-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.3.1-2.4">
              <p id="section-4.3.1-2.4.1">Only in the case of a v3 PKESK packet: a one-octet symmetric algorithm identifier.<a href="#section-4.3.1-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.3.1-2.5">
              <p id="section-4.3.1-2.5.1">The wrapped session key represented as an octet string.<a href="#section-4.3.1-2.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.3.1-3">Note that like in the case of the algorithms X25519 and X448 specified in <span>[<a href="#I-D.ietf-openpgp-crypto-refresh" class="cite xref">I-D.ietf-openpgp-crypto-refresh</a>]</span>, for the ML-KEM composite schemes, in the case of a v3 PKESK packet, the symmetric algorithm identifier is not encrypted.
Instead, it is placed in plaintext after the <code>mlkemCipherText</code> and before the length octet preceding the wrapped session key.
In the case of v3 PKESK packets for ML-KEM composite schemes, the symmetric algorithm used MUST be AES-128, AES-192 or AES-256 (algorithm ID 7, 8 or 9).<a href="#section-4.3.1-3" class="pilcrow">¶</a></p>
<p id="section-4.3.1-4">In the case of a v3 PKESK, a receiving implementation MUST check if the length of the unwrapped symmetric key matches the symmetric algorithm identifier, and abort if this is not the case.<a href="#section-4.3.1-4" class="pilcrow">¶</a></p>
<p id="section-4.3.1-5">Implementations MUST NOT use the obsolete Symmetrically Encrypted Data packet (tag 9) to encrypt data protected with the algorithms described in this document.<a href="#section-4.3.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="mlkem-ecc-key">
<section id="section-4.3.2">
          <h4 id="name-key-material-packets">
<a href="#section-4.3.2" class="section-number selfRef">4.3.2. </a><a href="#name-key-material-packets" class="section-name selfRef">Key Material Packets</a>
          </h4>
<p id="section-4.3.2-1">The algorithm-specific public key is this series of values:<a href="#section-4.3.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2-2.1">
              <p id="section-4.3.2-2.1.1">A fixed-length octet string representing an EC point public key, in the point format associated with the curve specified in <a href="#ecc-kem" class="auto internal xref">Section 4.1.1</a>.<a href="#section-4.3.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.3.2-2.2">
              <p id="section-4.3.2-2.2.1">A fixed-length octet string containing the ML-KEM public key, whose length depends on the algorithm ID as specified in <a href="#tab-mlkem-artifacts" class="auto internal xref">Table 4</a>.<a href="#section-4.3.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.3.2-3">The algorithm-specific secret key is these two values:<a href="#section-4.3.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2-4.1">
              <p id="section-4.3.2-4.1.1">A fixed-length octet string of the encoded secret scalar, whose encoding and length depend on the algorithm ID as specified in <a href="#ecc-kem" class="auto internal xref">Section 4.1.1</a>.<a href="#section-4.3.2-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.3.2-4.2">
              <p id="section-4.3.2-4.2.1">A fixed-length octet string containing the ML-KEM secret key, whose length depends on the algorithm ID as specified in <a href="#tab-mlkem-artifacts" class="auto internal xref">Table 4</a>.<a href="#section-4.3.2-4.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="composite-signature-schemes">
<section id="section-5">
      <h2 id="name-composite-signature-schemes">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-composite-signature-schemes" class="section-name selfRef">Composite Signature Schemes</a>
      </h2>
<div id="building-blocks-1">
<section id="section-5.1">
        <h3 id="name-building-blocks-2">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-building-blocks-2" class="section-name selfRef">Building blocks</a>
        </h3>
<div id="eddsa-signature">
<section id="section-5.1.1">
          <h4 id="name-eddsa-based-signatures">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-eddsa-based-signatures" class="section-name selfRef">EdDSA-Based signatures</a>
          </h4>
<p id="section-5.1.1-1">To sign and verify with EdDSA the following operations are defined:<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.1-2">
<pre>
(eddsaSignature) &lt;- EdDSA.Sign(eddsaSecretKey, dataDigest)
</pre><a href="#section-5.1.1-2" class="pilcrow">¶</a>
</div>
<p id="section-5.1.1-3">and<a href="#section-5.1.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.1-4">
<pre>
(verified) &lt;- EdDSA.Verify(eddsaPublicKey, eddsaSignature, dataDigest)
</pre><a href="#section-5.1.1-4" class="pilcrow">¶</a>
</div>
<p id="section-5.1.1-5">The public and secret key, as well as the signature MUST be encoded according to <span>[<a href="#RFC8032" class="cite xref">RFC8032</a>]</span> as fixed-length octet strings.
The following table describes the EdDSA parameters and artifact lengths:<a href="#section-5.1.1-5" class="pilcrow">¶</a></p>
<span id="name-eddsa-parameters-and-artifa"></span><div id="tab-eddsa-artifacts">
<table class="center" id="table-6">
            <caption>
<a href="#table-6" class="selfRef">Table 6</a>:
<a href="#name-eddsa-parameters-and-artifa" class="selfRef">EdDSA parameters and artifact lengths in octets</a>
            </caption>
<thead>
              <tr>
                <th class="text-right" rowspan="1" colspan="1">Algorithm ID reference</th>
                <th class="text-left" rowspan="1" colspan="1">Curve</th>
                <th class="text-left" rowspan="1" colspan="1">Field size</th>
                <th class="text-left" rowspan="1" colspan="1">Public key</th>
                <th class="text-left" rowspan="1" colspan="1">Secret key</th>
                <th class="text-left" rowspan="1" colspan="1">Signature</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">TBD (107 for testing)</td>
                <td class="text-left" rowspan="1" colspan="1">Ed25519</td>
                <td class="text-left" rowspan="1" colspan="1">32</td>
                <td class="text-left" rowspan="1" colspan="1">32</td>
                <td class="text-left" rowspan="1" colspan="1">32</td>
                <td class="text-left" rowspan="1" colspan="1">64</td>
              </tr>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">TBD (108 for testing)</td>
                <td class="text-left" rowspan="1" colspan="1">Ed448</td>
                <td class="text-left" rowspan="1" colspan="1">57</td>
                <td class="text-left" rowspan="1" colspan="1">57</td>
                <td class="text-left" rowspan="1" colspan="1">57</td>
                <td class="text-left" rowspan="1" colspan="1">114</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
<div id="mldsa-signature">
<section id="section-5.1.2">
          <h4 id="name-ml-dsa-signatures">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-ml-dsa-signatures" class="section-name selfRef">ML-DSA signatures</a>
          </h4>
<p id="section-5.1.2-1">For ML-DSA signature generation the default hedged version of <code>ML-DSA.Sign</code> given in <span>[<a href="#FIPS-204" class="cite xref">FIPS-204</a>]</span> is used.
That is, to sign with ML-DSA the following operation is defined:<a href="#section-5.1.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.2-2">
<pre>
(mldsaSignature) &lt;- ML-DSA.Sign(mldsaSecretKey, dataDigest)
</pre><a href="#section-5.1.2-2" class="pilcrow">¶</a>
</div>
<p id="section-5.1.2-3">For ML-DSA signature verification the algorithm ML-DSA.Verify given in <span>[<a href="#FIPS-204" class="cite xref">FIPS-204</a>]</span> is used.
That is, to verify with ML-DSA the following operation is defined:<a href="#section-5.1.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.2-4">
<pre>
(verified) &lt;- ML-DSA.Verify(mldsaPublicKey, dataDigest, mldsaSignature)
</pre><a href="#section-5.1.2-4" class="pilcrow">¶</a>
</div>
<p id="section-5.1.2-5">ML-DSA has the parametrization with the corresponding artifact lengths in octets as given in <a href="#tab-mldsa-artifacts" class="auto internal xref">Table 7</a>.
All artifacts are encoded as defined in <span>[<a href="#FIPS-204" class="cite xref">FIPS-204</a>]</span>.<a href="#section-5.1.2-5" class="pilcrow">¶</a></p>
<span id="name-ml-dsa-parameters-and-artif"></span><div id="tab-mldsa-artifacts">
<table class="center" id="table-7">
            <caption>
<a href="#table-7" class="selfRef">Table 7</a>:
<a href="#name-ml-dsa-parameters-and-artif" class="selfRef">ML-DSA parameters and artifact lengths in octets</a>
            </caption>
<thead>
              <tr>
                <th class="text-right" rowspan="1" colspan="1">Algorithm ID reference</th>
                <th class="text-left" rowspan="1" colspan="1">ML-DSA</th>
                <th class="text-left" rowspan="1" colspan="1">Public key</th>
                <th class="text-left" rowspan="1" colspan="1">Secret key</th>
                <th class="text-left" rowspan="1" colspan="1">Signature value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">TBD (107 for testing)</td>
                <td class="text-left" rowspan="1" colspan="1">ML-DSA-65</td>
                <td class="text-left" rowspan="1" colspan="1">1952</td>
                <td class="text-left" rowspan="1" colspan="1">4032</td>
                <td class="text-left" rowspan="1" colspan="1">3293</td>
              </tr>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">TBD (108 for testing)</td>
                <td class="text-left" rowspan="1" colspan="1">ML-DSA-87</td>
                <td class="text-left" rowspan="1" colspan="1">2592</td>
                <td class="text-left" rowspan="1" colspan="1">4896</td>
                <td class="text-left" rowspan="1" colspan="1">4595</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
</section>
</div>
<div id="ecc-mldsa">
<section id="section-5.2">
        <h3 id="name-composite-signature-schemes-">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-composite-signature-schemes-" class="section-name selfRef">Composite Signature Schemes with ML-DSA</a>
        </h3>
<div id="mldsa-sig-data-digest">
<section id="section-5.2.1">
          <h4 id="name-signature-data-digest">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-signature-data-digest" class="section-name selfRef">Signature data digest</a>
          </h4>
<p id="section-5.2.1-1">Signature data (i.e. the data to be signed) is digested prior to signing operations, see <span>[<a href="#I-D.ietf-openpgp-crypto-refresh" class="cite xref">I-D.ietf-openpgp-crypto-refresh</a>]</span>, Section 5.2.4.
Composite ML-DSA + EdDSA signatures MUST use the associated hash algorithm as specified in <a href="#tab-mldsa-hash" class="auto internal xref">Table 8</a> for the signature data digest.
Signatures using other hash algorithms MUST be considered invalid.<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<p id="section-5.2.1-2">An implementation supporting a specific ML-DSA + EdDSA algorithm MUST also support the matching hash algorithm.<a href="#section-5.2.1-2" class="pilcrow">¶</a></p>
<span id="name-binding-between-ml-dsa-and-"></span><div id="tab-mldsa-hash">
<table class="center" id="table-8">
            <caption>
<a href="#table-8" class="selfRef">Table 8</a>:
<a href="#name-binding-between-ml-dsa-and-" class="selfRef">Binding between ML-DSA and signature data digest</a>
            </caption>
<thead>
              <tr>
                <th class="text-right" rowspan="1" colspan="1">Algorithm ID reference</th>
                <th class="text-left" rowspan="1" colspan="1">Hash function</th>
                <th class="text-left" rowspan="1" colspan="1">Hash function ID reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">TBD (107 for testing)</td>
                <td class="text-left" rowspan="1" colspan="1">SHA3-256</td>
                <td class="text-left" rowspan="1" colspan="1">12</td>
              </tr>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">TBD (108 for testing)</td>
                <td class="text-left" rowspan="1" colspan="1">SHA3-512</td>
                <td class="text-left" rowspan="1" colspan="1">14</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
<div id="ecc-mldsa-generation">
<section id="section-5.2.2">
          <h4 id="name-key-generation-procedure-2">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-key-generation-procedure-2" class="section-name selfRef">Key generation procedure</a>
          </h4>
<p id="section-5.2.2-1">The implementation MUST independently generate the ML-DSA and the EdDSA component keys.
ML-DSA key generation follows the specification <span>[<a href="#FIPS-204" class="cite xref">FIPS-204</a>]</span> and the artifacts are encoded as fixed-length octet strings as defined in <a href="#mldsa-signature" class="auto internal xref">Section 5.1.2</a>.
For EdDSA this is done following the relative specification in <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>, and encoding the artifacts as specified in <a href="#eddsa-signature" class="auto internal xref">Section 5.1.1</a> as fixed-length octet strings.<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="signature-generation">
<section id="section-5.2.3">
          <h4 id="name-signature-generation">
<a href="#section-5.2.3" class="section-number selfRef">5.2.3. </a><a href="#name-signature-generation" class="section-name selfRef">Signature Generation</a>
          </h4>
<p id="section-5.2.3-1">To sign a message <code>M</code> with ML-DSA + EdDSA the following sequence of operations has to be performed:<a href="#section-5.2.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.2.3-2">
<li id="section-5.2.3-2.1">
              <p id="section-5.2.3-2.1.1">Generate <code>dataDigest</code> according to <span>[<a href="#I-D.ietf-openpgp-crypto-refresh" class="cite xref">I-D.ietf-openpgp-crypto-refresh</a>]</span>, Section 5.2.4<a href="#section-5.2.3-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.2.3-2.2">
              <p id="section-5.2.3-2.2.1">Create the EdDSA signature over <code>dataDigest</code> with <code>EdDSA.Sign()</code> from <a href="#eddsa-signature" class="auto internal xref">Section 5.1.1</a><a href="#section-5.2.3-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.2.3-2.3">
              <p id="section-5.2.3-2.3.1">Create the ML-DSA signature over <code>dataDigest</code> with <code>ML-DSA.Sign()</code> from <a href="#mldsa-signature" class="auto internal xref">Section 5.1.2</a><a href="#section-5.2.3-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.2.3-2.4">
              <p id="section-5.2.3-2.4.1">Encode the EdDSA and ML-DSA signatures according to the packet structure given in <a href="#ecc-mldsa-sig-packet" class="auto internal xref">Section 5.3.1</a>.<a href="#section-5.2.3-2.4.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
<div id="signature-verification">
<section id="section-5.2.4">
          <h4 id="name-signature-verification">
<a href="#section-5.2.4" class="section-number selfRef">5.2.4. </a><a href="#name-signature-verification" class="section-name selfRef">Signature Verification</a>
          </h4>
<p id="section-5.2.4-1">To verify an ML-DSA + EdDSA signature the following sequence of operations has to be performed:<a href="#section-5.2.4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.2.4-2">
<li id="section-5.2.4-2.1">
              <p id="section-5.2.4-2.1.1">Verify the EdDSA signature with <code>EdDSA.Verify()</code> from <a href="#eddsa-signature" class="auto internal xref">Section 5.1.1</a><a href="#section-5.2.4-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.2.4-2.2">
              <p id="section-5.2.4-2.2.1">Verify the ML-DSA signature with <code>ML-DSA.Verify()</code> from <a href="#mldsa-signature" class="auto internal xref">Section 5.1.2</a><a href="#section-5.2.4-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-5.2.4-3">As specified in <a href="#composite-signatures" class="auto internal xref">Section 3.3</a> an implementation MUST validate both signatures, i.e. EdDSA and ML-DSA, successfully to state that a composite ML-DSA + EdDSA signature is valid.<a href="#section-5.2.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="packet-specifications-1">
<section id="section-5.3">
        <h3 id="name-packet-specifications-2">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-packet-specifications-2" class="section-name selfRef">Packet Specifications</a>
        </h3>
<div id="ecc-mldsa-sig-packet">
<section id="section-5.3.1">
          <h4 id="name-signature-packet-tag-2">
<a href="#section-5.3.1" class="section-number selfRef">5.3.1. </a><a href="#name-signature-packet-tag-2" class="section-name selfRef">Signature Packet (Tag 2)</a>
          </h4>
<p id="section-5.3.1-1">The composite ML-DSA + EdDSA schemes MUST be used only with v6 signatures, as defined in <span>[<a href="#I-D.ietf-openpgp-crypto-refresh" class="cite xref">I-D.ietf-openpgp-crypto-refresh</a>]</span>.<a href="#section-5.3.1-1" class="pilcrow">¶</a></p>
<p id="section-5.3.1-2">The algorithm-specific v6 signature parameters for ML-DSA + EdDSA signatures consist of:<a href="#section-5.3.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.1-3.1">
              <p id="section-5.3.1-3.1.1">A fixed-length octet string representing the EdDSA signature, whose length depends on the algorithm ID as specified in <a href="#tab-eddsa-artifacts" class="auto internal xref">Table 6</a>.<a href="#section-5.3.1-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.3.1-3.2">
              <p id="section-5.3.1-3.2.1">A fixed-length octet string of the ML-DSA signature value, whose length depends on the algorithm ID as specified in <a href="#tab-mldsa-artifacts" class="auto internal xref">Table 7</a>.<a href="#section-5.3.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="key-material-packets">
<section id="section-5.3.2">
          <h4 id="name-key-material-packets-2">
<a href="#section-5.3.2" class="section-number selfRef">5.3.2. </a><a href="#name-key-material-packets-2" class="section-name selfRef">Key Material Packets</a>
          </h4>
<p id="section-5.3.2-1">The composite ML-DSA + EdDSA schemes MUST be used only with v6 keys, as defined in <span>[<a href="#I-D.ietf-openpgp-crypto-refresh" class="cite xref">I-D.ietf-openpgp-crypto-refresh</a>]</span>.<a href="#section-5.3.2-1" class="pilcrow">¶</a></p>
<p id="section-5.3.2-2">The algorithm-specific public key for ML-DSA + EdDSA keys is this series of values:<a href="#section-5.3.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.2-3.1">
              <p id="section-5.3.2-3.1.1">A fixed-length octet string representing the EdDSA public key, whose length depends on the algorithm ID as specified in <a href="#tab-eddsa-artifacts" class="auto internal xref">Table 6</a>.<a href="#section-5.3.2-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.3.2-3.2">
              <p id="section-5.3.2-3.2.1">A fixed-length octet string containing the ML-DSA public key, whose length depends on the algorithm ID as specified in <a href="#tab-mldsa-artifacts" class="auto internal xref">Table 7</a>.<a href="#section-5.3.2-3.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-5.3.2-4">The algorithm-specific secret key for ML-DSA + EdDSA keys is this series of values:<a href="#section-5.3.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.2-5.1">
              <p id="section-5.3.2-5.1.1">A fixed-length octet string representing the EdDSA secret key, whose length depends on the algorithm ID as specified in <a href="#tab-eddsa-artifacts" class="auto internal xref">Table 6</a>.<a href="#section-5.3.2-5.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.3.2-5.2">
              <p id="section-5.3.2-5.2.1">A fixed-length octet string containing the ML-DSA secret key, whose length depends on the algorithm ID as specified in <a href="#tab-mldsa-artifacts" class="auto internal xref">Table 7</a>.<a href="#section-5.3.2-5.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="slh-dsa-shake-1">
<section id="section-6">
      <h2 id="name-slh-dsa-shake-2">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-slh-dsa-shake-2" class="section-name selfRef">SLH-DSA-SHAKE</a>
      </h2>
<div id="slhdsa">
<section id="section-6.1">
        <h3 id="name-the-slh-dsa-shake-algorithm">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-the-slh-dsa-shake-algorithm" class="section-name selfRef">The SLH-DSA-SHAKE Algorithms</a>
        </h3>
<p id="section-6.1-1">The following table lists the group of algorithm code points for the SLH-DSA-SHAKE signature scheme and the corresponding artifact lengths.
This group of algorithms is henceforth referred to as "SLH-DSA-SHAKE code points".<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<span id="name-slh-dsa-shake-algorithm-cod"></span><div id="slhdsa-artifact-lengths">
<table class="center" id="table-9">
          <caption>
<a href="#table-9" class="selfRef">Table 9</a>:
<a href="#name-slh-dsa-shake-algorithm-cod" class="selfRef">SLH-DSA-SHAKE algorithm code points and the corresponding artifact lengths in octets.</a>
          </caption>
<thead>
            <tr>
              <th class="text-right" rowspan="1" colspan="1">Algorithm ID reference</th>
              <th class="text-left" rowspan="1" colspan="1">SLH-DSA-SHAKE public key</th>
              <th class="text-left" rowspan="1" colspan="1">SLH-DSA-SHAKE secret key</th>
              <th class="text-left" rowspan="1" colspan="1">SLH-DSA-SHAKE signature</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">TBD (SLH-DSA-SHAKE-128s)</td>
              <td class="text-left" rowspan="1" colspan="1">32</td>
              <td class="text-left" rowspan="1" colspan="1">64</td>
              <td class="text-left" rowspan="1" colspan="1">7856</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">TBD (SLH-DSA-SHAKE-128f)</td>
              <td class="text-left" rowspan="1" colspan="1">32</td>
              <td class="text-left" rowspan="1" colspan="1">64</td>
              <td class="text-left" rowspan="1" colspan="1">17088</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">TBD (SLH-DSA-SHAKE-256s)</td>
              <td class="text-left" rowspan="1" colspan="1">64</td>
              <td class="text-left" rowspan="1" colspan="1">128</td>
              <td class="text-left" rowspan="1" colspan="1">29792</td>
            </tr>
          </tbody>
        </table>
</div>
<div id="slhdsa-sig-data-digest">
<section id="section-6.1.1">
          <h4 id="name-signature-data-digest-2">
<a href="#section-6.1.1" class="section-number selfRef">6.1.1. </a><a href="#name-signature-data-digest-2" class="section-name selfRef">Signature Data Digest</a>
          </h4>
<p id="section-6.1.1-1">Signature data (i.e. the data to be signed) is digested prior to signing operations, see <span>[<a href="#I-D.ietf-openpgp-crypto-refresh" class="cite xref">I-D.ietf-openpgp-crypto-refresh</a>]</span>, Section 5.2.4.
SLH-DSA-SHAKE signatures MUST use the associated hash algorithm as specified in <a href="#tab-slhdsa-hash" class="auto internal xref">Table 10</a> for the signature data digest.
Signatures using other hash algorithms MUST be considered invalid.<a href="#section-6.1.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1.1-2">An implementation supporting a specific SLH-DSA-SHAKE algorithm code point MUST also support the matching hash algorithm.<a href="#section-6.1.1-2" class="pilcrow">¶</a></p>
<span id="name-binding-between-slh-dsa-sha"></span><div id="tab-slhdsa-hash">
<table class="center" id="table-10">
            <caption>
<a href="#table-10" class="selfRef">Table 10</a>:
<a href="#name-binding-between-slh-dsa-sha" class="selfRef">Binding between SLH-DSA-SHAKE algorithm code points and signature data hash algorithms</a>
            </caption>
<thead>
              <tr>
                <th class="text-right" rowspan="1" colspan="1">Algorithm ID reference</th>
                <th class="text-left" rowspan="1" colspan="1">Hash function</th>
                <th class="text-left" rowspan="1" colspan="1">Hash function ID reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">TBD (SLH-DSA-SHAKE-128s)</td>
                <td class="text-left" rowspan="1" colspan="1">SHA3-256</td>
                <td class="text-left" rowspan="1" colspan="1">12</td>
              </tr>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">TBD (SLH-DSA-SHAKE-128f)</td>
                <td class="text-left" rowspan="1" colspan="1">SHA3-256</td>
                <td class="text-left" rowspan="1" colspan="1">12</td>
              </tr>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">TBD (SLH-DSA-SHAKE-256s)</td>
                <td class="text-left" rowspan="1" colspan="1">SHA3-512</td>
                <td class="text-left" rowspan="1" colspan="1">14</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
<div id="key-generation">
<section id="section-6.1.2">
          <h4 id="name-key-generation">
<a href="#section-6.1.2" class="section-number selfRef">6.1.2. </a><a href="#name-key-generation" class="section-name selfRef">Key generation</a>
          </h4>
<p id="section-6.1.2-1">SLH-DSA-SHAKE key generation is performed via the algorithm <code>SLH-DSA.KeyGen</code> as specified in <span>[<a href="#FIPS-205" class="cite xref">FIPS-205</a>]</span>, and the artifacts are encoded as fixed-length octet strings as defined in <a href="#slhdsa" class="auto internal xref">Section 6.1</a>.<a href="#section-6.1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="signature-generation-1">
<section id="section-6.1.3">
          <h4 id="name-signature-generation-2">
<a href="#section-6.1.3" class="section-number selfRef">6.1.3. </a><a href="#name-signature-generation-2" class="section-name selfRef">Signature Generation</a>
          </h4>
<p id="section-6.1.3-1">SLH-DSA-SHAKE signature generation is performed via the algorithm <code>SLH-DSA.Sign</code> as specified in <span>[<a href="#FIPS-205" class="cite xref">FIPS-205</a>]</span>.
The variable <code>opt_rand</code> is set to <code>PK.seed</code>.
See also <a href="#slhdsa-sec-cons" class="auto internal xref">Section 9.5</a>.<a href="#section-6.1.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="signature-verification-1">
<section id="section-6.1.4">
          <h4 id="name-signature-verification-2">
<a href="#section-6.1.4" class="section-number selfRef">6.1.4. </a><a href="#name-signature-verification-2" class="section-name selfRef">Signature Verification</a>
          </h4>
<p id="section-6.1.4-1">SLH-DSA-SHAKE signature verification is performed via the algorithm <code>SLH-DSA.Verify</code> as specified in <span>[<a href="#FIPS-205" class="cite xref">FIPS-205</a>]</span>.<a href="#section-6.1.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="packet-specifications-2">
<section id="section-6.2">
        <h3 id="name-packet-specifications-3">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-packet-specifications-3" class="section-name selfRef">Packet specifications</a>
        </h3>
<div id="signature-packet-tag-2">
<section id="section-6.2.1">
          <h4 id="name-signature-packet-tag-2-2">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-signature-packet-tag-2-2" class="section-name selfRef">Signature Packet (Tag 2)</a>
          </h4>
<p id="section-6.2.1-1">The SLH-DSA-SHAKE algorithms MUST be used only with v6 signatures, as defined in <span>[<a href="#I-D.ietf-openpgp-crypto-refresh" class="cite xref">I-D.ietf-openpgp-crypto-refresh</a>]</span>, Section 5.2.3.<a href="#section-6.2.1-1" class="pilcrow">¶</a></p>
<p id="section-6.2.1-2">The algorithm-specific part of a signature packet for an SLH-DSA-SHAKE algorithm code point consists of:<a href="#section-6.2.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.1-3.1">
              <p id="section-6.2.1-3.1.1">A fixed-length octet string of the SLH-DSA-SHAKE signature value, whose length depends on the algorithm ID in the format specified in <a href="#slhdsa-artifact-lengths" class="auto internal xref">Table 9</a>.<a href="#section-6.2.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="key-material-packets-1">
<section id="section-6.2.2">
          <h4 id="name-key-material-packets-3">
<a href="#section-6.2.2" class="section-number selfRef">6.2.2. </a><a href="#name-key-material-packets-3" class="section-name selfRef">Key Material Packets</a>
          </h4>
<p id="section-6.2.2-1">The SLH-DSA-SHAKE algorithms code points MUST be used only with v6 keys, as defined in <span>[<a href="#I-D.ietf-openpgp-crypto-refresh" class="cite xref">I-D.ietf-openpgp-crypto-refresh</a>]</span>.<a href="#section-6.2.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2.2-2">The algorithm-specific part of the public key consists of:<a href="#section-6.2.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.2-3.1">
              <p id="section-6.2.2-3.1.1">A fixed-length octet string containing the SLH-DSA-SHAKE public key, whose length depends on the algorithm ID as specified in <a href="#slhdsa-artifact-lengths" class="auto internal xref">Table 9</a>.<a href="#section-6.2.2-3.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-6.2.2-4">The algorithm-specific part of the secret key consists of:<a href="#section-6.2.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.2-5.1">
              <p id="section-6.2.2-5.1.1">A fixed-length octet string containing the SLH-DSA-SHAKE secret key, whose length depends on the algorithm ID as specified in <a href="#slhdsa-artifact-lengths" class="auto internal xref">Table 9</a>.<a href="#section-6.2.2-5.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="notes-on-algorithms">
<section id="section-7">
      <h2 id="name-notes-on-algorithms">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-notes-on-algorithms" class="section-name selfRef">Notes on Algorithms</a>
      </h2>
<div id="symmetric-algorithms-for-seipd-packets">
<section id="section-7.1">
        <h3 id="name-symmetric-algorithms-for-se">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-symmetric-algorithms-for-se" class="section-name selfRef">Symmetric Algorithms for SEIPD Packets</a>
        </h3>
<p id="section-7.1-1">Implementations MUST implement <code>AES-256</code>.
An implementation SHOULD use <code>AES-256</code> in the case of a v1 SEIPD packet, or <code>AES-256</code> with any available AEAD mode in the case of a v2 SEIPD packet, if all recipients indicate support for it (explicitly or implicitly).<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">A v4 or v6 certificate that contains a PQ(/T) key SHOULD include <code>AES-256</code> in the "Preferred Symmetric Ciphers for v1 SEIPD" subpacket.
A v6 certificate that contains a PQ(/T) key SHOULD include the pair <code>AES-256</code> with <code>OCB</code> in the "Preferred AEAD Ciphersuites" subpacket.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3">If <code>AES-256</code> is not explicitly in the list of the "Preferred Symmetric Ciphers for v1 SEIPD" subpacket, and if the certificate contains a PQ/T key, it is implicitly at the end of the list.
This is justified since <code>AES-256</code> is mandatory to implement.
If <code>AES-128</code> is also implicitly added to the list, it is added after <code>AES-256</code>.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
<p id="section-7.1-4">If the pair <code>AES-256</code> with <code>OCB</code> is not explicitly in the list of the "Preferred AEAD Ciphersuites" subpacket, and if the certificate contains a PQ/T key, it is implicitly at the end of the list.
This is justified since <code>AES-256</code> and <code>OCB</code> are mandatory to implement.
If the pair <code>AES-128</code> with <code>OCB</code> is also implicitly added to the list, it is added after the pair <code>AES-256</code> with <code>OCB</code>.<a href="#section-7.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="hash-algorithms-for-key-binding-signatures">
<section id="section-7.2">
        <h3 id="name-hash-algorithms-for-key-bin">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-hash-algorithms-for-key-bin" class="section-name selfRef">Hash Algorithms for Key Binding Signatures</a>
        </h3>
<p id="section-7.2-1">Subkey binding signatures over algorithms described in this document and primary key binding signatures made by algorithms described in this document MUST NOT be made with <code>MD5</code>, <code>SHA-1</code>, or <code>RIPEMD-160</code>.
A receiving implementation MUST treat such a signature as invalid.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="migration-considerations">
<section id="section-8">
      <h2 id="name-migration-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-migration-considerations" class="section-name selfRef">Migration Considerations</a>
      </h2>
<p id="section-8-1">The post-quantum KEM algorithms defined in <a href="#kem-alg-specs" class="auto internal xref">Table 1</a> and the signature algorithms defined in <a href="#sig-alg-specs" class="auto internal xref">Table 2</a> are a set of new public key algorithms that extend the algorithm selection of <span>[<a href="#I-D.ietf-openpgp-crypto-refresh" class="cite xref">I-D.ietf-openpgp-crypto-refresh</a>]</span>.
During the transition period, the post-quantum algorithms will not be supported by all clients.
Therefore various migration considerations must be taken into account, in particular backwards compatibility to existing implementations that have not yet been updated to support the post-quantum algorithms.<a href="#section-8-1" class="pilcrow">¶</a></p>
<div id="key-preference">
<section id="section-8.1">
        <h3 id="name-key-preference">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-key-preference" class="section-name selfRef">Key preference</a>
        </h3>
<p id="section-8.1-1">Implementations SHOULD prefer PQ(/T) keys when multiple options are available.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">For instance, if encrypting for a recipient for which both a valid PQ/T and a valid ECC certificate are available, the implementation SHOULD choose the PQ/T certificate.
In case a certificate has both a PQ/T and an ECC encryption-capable valid subkey, the PQ/T subkey SHOULD be preferred.<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<p id="section-8.1-3">An implementation MAY sign with both a PQ(/T) and an ECC key using multiple signatures over the same data as described in <a href="#multiple-signatures" class="auto internal xref">Section 3.4</a>.
Signing only with PQ(/T) key material is not backwards compatible.<a href="#section-8.1-3" class="pilcrow">¶</a></p>
<p id="section-8.1-4">Note that the confidentiality of a message is not post-quantum secure when encrypting to multiple recipients if at least one recipient does not support PQ/T encryption schemes.
An implementation SHOULD NOT abort the encryption process in this case to allow for a smooth transition to post-quantum cryptography.<a href="#section-8.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-generation-strategies">
<section id="section-8.2">
        <h3 id="name-key-generation-strategies">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-key-generation-strategies" class="section-name selfRef">Key generation strategies</a>
        </h3>
<p id="section-8.2-1">It is RECOMMENDED to generate fresh secrets when generating PQ(/T) keys.
Note that reusing key material from existing ECC keys in PQ(/T) keys does not provide backwards compatibility.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2-2">An OpenPGP certificate is composed of a certification-capable primary key and one or more subkeys for signature, encryption, and authentication.
Two migration strategies are recommended:<a href="#section-8.2-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-8.2-3">
<li id="section-8.2-3.1">
            <p id="section-8.2-3.1.1">Generate two independent certificates, one for PQ(/T)-capable implementations, and one for legacy implementations.
Implementations not understanding PQ(/T) certificates can use the legacy certificate, while PQ(/T)-capable implementations will prefer the newer certificate.
This allows having an older v4 or v6 certificate for compatibility and a v6 PQ(/T) certificate, at a greater complexity in key distribution.<a href="#section-8.2-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-8.2-3.2">
            <p id="section-8.2-3.2.1">Attach PQ(/T) encryption subkeys to an existing traditional OpenPGP certificate.
In the case of a v6 certificate, also PQ(/T) signature keys may be attached.
Implementations understanding PQ(/T) will be able to parse and use the subkeys, while PQ(/T)-incapable implementations can gracefully ignore them.
This simplifies key distribution, as only one certificate needs to be communicated and verified, but leaves the primary key vulnerable to quantum computer attacks.<a href="#section-8.2-3.2.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-9">
      <h2 id="name-security-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="security-aspects-of-composite-signatures">
<section id="section-9.1">
        <h3 id="name-security-aspects-of-composi">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-security-aspects-of-composi" class="section-name selfRef">Security Aspects of Composite Signatures</a>
        </h3>
<p id="section-9.1-1">When multiple signatures are applied to a message, the question of the protocol's resistance against signature stripping attacks naturally arises.
In a signature stripping attack, an adversary removes one or more of the transmitted signatures such that only a subset of the signatures originally applied by the sender remain in the message that reaches the recipient.
This amounts to a downgrade attack that potentially reduces the value of the signature.
It should be noted that the composite signature schemes specified in this draft are not subject to a signature stripping vulnerability.
This is due to the fact that in any OpenPGP signature, the hashed meta data includes the signature algorithm ID, as specified in <span>[<a href="#I-D.ietf-openpgp-crypto-refresh" class="cite xref">I-D.ietf-openpgp-crypto-refresh</a>]</span>, Section 5.2.4.
As a consequence, a component signature taken out of the context of a specific composite algorithm is not a valid signature for any message.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1-2">Furthermore, it is also not possible to craft a new signature for a message that was signed twice with a composite algorithm by interchanging (i.e., remixing) the component signatures, which would classify as a weak existential forgery.
This is due to the fact that each v6 signatures also includes a random salt at the start of the hashed meta data, as also specified in the aforementioned reference.<a href="#section-9.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="hashing-in-ecdh-kem">
<section id="section-9.2">
        <h3 id="name-hashing-in-ecdh-kem">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-hashing-in-ecdh-kem" class="section-name selfRef">Hashing in ECDH-KEM</a>
        </h3>
<p id="section-9.2-1">Our construction of the ECDH-KEMs, in particular the inclusion of <code>ecdhCipherText</code> in the final hashing step in encapsulation and decapsulation that produces the <code>ecdhKeyShare</code>, is standard and known as hashed ElGamal key encapsulation, a hashed variant of ElGamal encryption.
It ensures IND-CCA2 security in the random oracle model under some Diffie-Hellman intractability assumptions <span>[<a href="#CS03" class="cite xref">CS03</a>]</span>.
The additional inclusion of <code>ecdhPublicKey</code> follows the security advice in Section 6.1 of <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-key-combiner">
<section id="section-9.3">
        <h3 id="name-key-combiner-2">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-key-combiner-2" class="section-name selfRef">Key combiner</a>
        </h3>
<p id="section-9.3-1">For the key combination in <a href="#kem-key-combiner" class="auto internal xref">Section 4.2.2</a> this specification limits itself to the use of SHA3-256.
The sponge construction used by SHA3-256 was proven to be indifferentiable from a random oracle <span>[<a href="#BDPA08" class="cite xref">BDPA08</a>]</span>.
This means, that in contrast to SHA2, which uses a Merkle-Damgard construction, no HMAC-based construction is required for key combination.
It is therefore sufficient to simply process the concatenation of any number of key shares with a domain separation when using a sponge-based construction like SHA3-256.<a href="#section-9.3-1" class="pilcrow">¶</a></p>
<p id="section-9.3-2">More precisely, for a given capacity <code>c</code> the indifferentiability proof shows that assuming there are no weaknesses found in the Keccak permutation, an attacker has to make an expected number of <code>2^(c/2)</code> calls to the permutation to tell SHA3-256 from a random oracle.
For a random oracle, a difference in only a single bit gives an unrelated, uniformly random output.
Hence, to be able to distinguish a key <code>K</code>, derived from shared keys <code>K1</code> and <code>K2</code> (with ciphertexts <code>C1</code> and <code>C2</code> and public keys <code>P1</code> and <code>P2</code>) as<a href="#section-9.3-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.3-3">
<pre>
K = SHA3-256(counter || K1 || C1 || P1 || K2 || C2 || P2 || fixedInfo)
</pre><a href="#section-9.3-3" class="pilcrow">¶</a>
</div>
<p id="section-9.3-4">from a random bit string, an adversary has to know (or correctly guess) both key shares <code>K1</code> and <code>K2</code>, entirely.<a href="#section-9.3-4" class="pilcrow">¶</a></p>
<p id="section-9.3-5">The proposed construction in <a href="#kem-key-combiner" class="auto internal xref">Section 4.2.2</a> preserves IND-CCA2 of any of its ingredient KEMs, i.e. the newly formed combined KEM is IND-CCA2 secure as long as at least one of the ingredient KEMs is.
Indeed, the above stated indifferentiability from a random oracle qualifies Keccak as a split-key pseudorandom function as defined in <span>[<a href="#GHP18" class="cite xref">GHP18</a>]</span>.
That is, Keccak behaves like a random function if at least one input shared secret is picked uniformly at random.
Our construction can thus be seen as an instantiation of the IND-CCA2 preserving Example 3 in Figure 1 of <span>[<a href="#GHP18" class="cite xref">GHP18</a>]</span>, up to some reordering of input shared secrets and ciphertexts.
In the random oracle setting, the reordering does not influence the arguments in <span>[<a href="#GHP18" class="cite xref">GHP18</a>]</span>.<a href="#section-9.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-fixed-info">
<section id="section-9.4">
        <h3 id="name-domain-separation-and-bindi">
<a href="#section-9.4" class="section-number selfRef">9.4. </a><a href="#name-domain-separation-and-bindi" class="section-name selfRef">Domain separation and binding</a>
        </h3>
<p id="section-9.4-1">The <code>domSeparation</code> information defined in <a href="#kem-fixed-info" class="auto internal xref">Section 4.2.1</a> provides the domain separation for the key combiner construction.
This ensures that the input keying material is used to generate a KEK for a specific purpose or context.<a href="#section-9.4-1" class="pilcrow">¶</a></p>
<p id="section-9.4-2">The <code>algID</code> defined in <a href="#kem-fixed-info" class="auto internal xref">Section 4.2.1</a> binds the derived KEK to the chosen algorithm and communication parties.
The algorithm ID identifies unequivocally the algorithm, the parameters for its instantiation, and the length of all artifacts, including the derived key.<a href="#section-9.4-2" class="pilcrow">¶</a></p>
<p id="section-9.4-3">This is in line with the Recommendation for ECC in section 5.5 of <span>[<a href="#SP800-56A" class="cite xref">SP800-56A</a>]</span>.
Other fields included in the recommendation are not relevant for the OpenPGP protocol, since the sender is not required to have a key of their own, there are no pre-shared secrets, and all the other parameters are unequivocally defined by the algorithm ID.<a href="#section-9.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="slhdsa-sec-cons">
<section id="section-9.5">
        <h3 id="name-slh-dsa-shake-message-rando">
<a href="#section-9.5" class="section-number selfRef">9.5. </a><a href="#name-slh-dsa-shake-message-rando" class="section-name selfRef">SLH-DSA-SHAKE Message Randomizer</a>
        </h3>
<p id="section-9.5-1">The specification of SLH-DSA-SHAKE <span>[<a href="#FIPS-205" class="cite xref">FIPS-205</a>]</span> prescribes an optional non-deterministic message randomizer.
This is not used in this specification, as OpenPGP v6 signatures already provide a salted signature data digest of the appropriate size.<a href="#section-9.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="binding-hashes-in-signatures-with-signature-algorithms">
<section id="section-9.6">
        <h3 id="name-binding-hashes-in-signature">
<a href="#section-9.6" class="section-number selfRef">9.6. </a><a href="#name-binding-hashes-in-signature" class="section-name selfRef">Binding hashes in signatures with signature algorithms</a>
        </h3>
<p id="section-9.6-1">In order not to extend the attack surface, we bind the hash algorithm used for signature data digestion to the hash algorithm used internally by the signature algorithm.<a href="#section-9.6-1" class="pilcrow">¶</a></p>
<p id="section-9.6-2">ML-DSA internally uses a SHAKE256 digest, therefore we require SHA3 in the ML-DSA + EdDSA signature packet, see <a href="#mldsa-sig-data-digest" class="auto internal xref">Section 5.2.1</a>.
Note that we bind a NIST security category 2 hash function to a signature algorithm that falls into NIST security category 3.
This does not constitute a security bottleneck: because of the unpredictable random salt that is prepended to the digested data in v6 signatures, the hardness assumption is not collision resistance but second-preimage resistance.<a href="#section-9.6-2" class="pilcrow">¶</a></p>
<p id="section-9.6-3">In the case of SLH-DSA-SHAKE the internal hash algorithm varies based on the algorithm ID, see <a href="#slhdsa-sig-data-digest" class="auto internal xref">Section 6.1.1</a>.<a href="#section-9.6-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="symmetric-algorithms-for-seipd-packets-1">
<section id="section-9.7">
        <h3 id="name-symmetric-algorithms-for-sei">
<a href="#section-9.7" class="section-number selfRef">9.7. </a><a href="#name-symmetric-algorithms-for-sei" class="section-name selfRef">Symmetric Algorithms for SEIPD Packets</a>
        </h3>
<p id="section-9.7-1">This specification mandates support for <code>AES-256</code> for two reasons.
First, <code>AES-KeyWrap</code> with <code>AES-256</code> is already part of the composite KEM construction.
Second, some of the PQ(/T) algorithms target the security level of <code>AES-256</code>.<a href="#section-9.7-1" class="pilcrow">¶</a></p>
<p id="section-9.7-2">For the same reasons, this specification further recommends the use of <code>AES-256</code> if it is supported by all recipients, regardless of what the implementation would otherwise choose based on the recipients' preferences.
This recommendation should be understood as a clear and simple rule for the selection of <code>AES-256</code> for encryption.
Implementations may also make more nuanced decisions.<a href="#section-9.7-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="additional-considerations">
<section id="section-10">
      <h2 id="name-additional-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-additional-considerations" class="section-name selfRef">Additional considerations</a>
      </h2>
<div id="performance-considerations">
<section id="section-10.1">
        <h3 id="name-performance-considerations-">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-performance-considerations-" class="section-name selfRef">Performance Considerations for SLH-DSA-SHAKE</a>
        </h3>
<p id="section-10.1-1">This specification introduces both ML-DSA + EdDSA as well as SLH-DSA-SHAKE as PQ(/T) signature schemes.<a href="#section-10.1-1" class="pilcrow">¶</a></p>
<p id="section-10.1-2">Generally, it can be said that ML-DSA + EdDSA provides a performance in terms of execution time requirements that is close to that of traditional ECC signature schemes.
Regarding the size of signatures and public keys, though, ML-DSA has far greater requirements than traditional schemes like EC-based or even RSA signature schemes.<a href="#section-10.1-2" class="pilcrow">¶</a></p>
<p id="section-10.1-3">Implementers may want to offer SLH-DSA-SHAKE for applications where the weaker security assumptions of a hash-based signature scheme are required – namely only the 2nd preimage resistance of a hash function – and thus a potentially higher degree of trust in the long-term security of signatures is achieved.
However, SLH-DSA-SHAKE has performance characteristics in terms of execution time of the signature generation as well as space requirements for the signature that are even greater than those of ML-DSA + EdDSA signature schemes.<a href="#section-10.1-3" class="pilcrow">¶</a></p>
<p id="section-10.1-4">Pertaining to the execution time, the particularly costly operation in SLH-DSA-SHAKE is the signature generation.
Depending on the parameter set, it can range from approximately the one hundred fold to more than the two thousand fold of that of ML-DSA-87.
These number are based on the performance measurements published in the NIST submissions for SLH-DSA-SHAKE and ML-DSA.
In order to achieve fast signature generation times, the algorithm SLH-DSA-SHAKE-128f ("f" standing for "fast") should be chosen.
This comes at the expense of a larger signature size.
This choice can be relevant in applications where mass signing occurs or a small latency is required.<a href="#section-10.1-4" class="pilcrow">¶</a></p>
<p id="section-10.1-5">In order to minimize the space requirements of an SLH-DSA-SHAKE signature, an algorithm ID with the name ending in "s" for "small" should be chosen.
This comes at the expense of a longer signature generation time.
In particular, SLH-DSA-SHAKE-128s achieves the smallest possible signature size, which is about the double size of an ML-DSA-87 signature.
Where a higher security level than 128 bit is needed, SLH-DSA-SHAKE-256s can be used.<a href="#section-10.1-5" class="pilcrow">¶</a></p>
<p id="section-10.1-6">Unlike the signature generation time, the signature verification time of SLH-DSA-SHAKE is not that much larger than that of other PQC schemes.
Based on the performance measurements published in the NIST submissions for SLH-DSA-SHAKE and ML-DSA, the verification time of the SLH-DSA-SHAKE is, for the parameters covered by this specification, larger than that of ML-DSA-87 by a factor ranging from four (for -128s) over nine (for -256s) to twelve (for -128f).<a href="#section-10.1-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-11">
      <h2 id="name-iana-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-11-1">IANA is requested to add the algorithm IDs defined in <a href="#iana-pubkey-algos" class="auto internal xref">Table 11</a> to the existing registry <code>OpenPGP Public Key Algorithms</code>.
The field specifications enclosed in brackets for the ML-KEM + ECDH composite algorithms denote fields that are only conditionally contained in the data structure.<a href="#section-11-1" class="pilcrow">¶</a></p>
<span id="name-iana-updates-for-registry-o"></span><div id="iana-pubkey-algos">
<table class="center" id="table-11">
        <caption>
<a href="#table-11" class="selfRef">Table 11</a>:
<a href="#name-iana-updates-for-registry-o" class="selfRef">IANA updates for registry 'OpenPGP Public Key Algorithms'</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">ID</th>
            <th class="text-left" rowspan="1" colspan="1">Algorithm</th>
            <th class="text-right" rowspan="1" colspan="1">Public Key Format</th>
            <th class="text-right" rowspan="1" colspan="1">Secret Key Format</th>
            <th class="text-right" rowspan="1" colspan="1">Signature Format</th>
            <th class="text-right" rowspan="1" colspan="1">PKESK Format</th>
            <th class="text-right" rowspan="1" colspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
            <td class="text-left" rowspan="1" colspan="1">ML-KEM-768+X25519</td>
            <td class="text-right" rowspan="1" colspan="1">32 octets X25519 public key (<a href="#tab-ecdh-cfrg-artifacts" class="auto internal xref">Table 3</a>), 1184 octets ML-KEM-768 public key (<a href="#tab-mlkem-artifacts" class="auto internal xref">Table 4</a>)</td>
            <td class="text-right" rowspan="1" colspan="1">32 octets X25519 secret key (<a href="#tab-ecdh-cfrg-artifacts" class="auto internal xref">Table 3</a>), 2400 octets ML-KEM-768 secret-key (<a href="#tab-mlkem-artifacts" class="auto internal xref">Table 4</a>)</td>
            <td class="text-right" rowspan="1" colspan="1">N/A</td>
            <td class="text-right" rowspan="1" colspan="1">32 octets X25519 ciphertext, 1088 octets ML-KEM-768 ciphertext [, 1 octet algorithm ID in case of v3 PKESK], 1 octet length field of value <code>n</code>, <code>n</code> octets wrapped session key (<a href="#ecc-mlkem-pkesk" class="auto internal xref">Section 4.3.1</a>)</td>
            <td class="text-right" rowspan="1" colspan="1">
              <a href="#ecc-mlkem" class="auto internal xref">Section 4.2</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
            <td class="text-left" rowspan="1" colspan="1">ML-KEM-1024+X448</td>
            <td class="text-right" rowspan="1" colspan="1">56 octets X448 public key (<a href="#tab-ecdh-cfrg-artifacts" class="auto internal xref">Table 3</a>), 1568  octets ML-KEM-1024 public key (<a href="#tab-mlkem-artifacts" class="auto internal xref">Table 4</a>)</td>
            <td class="text-right" rowspan="1" colspan="1">56 octets X448 secret key (<a href="#tab-ecdh-cfrg-artifacts" class="auto internal xref">Table 3</a>), 3168 octets ML-KEM-1024 secret-key (<a href="#tab-mlkem-artifacts" class="auto internal xref">Table 4</a>)</td>
            <td class="text-right" rowspan="1" colspan="1">N/A</td>
            <td class="text-right" rowspan="1" colspan="1">56 octets X448 ciphertext, 1568 octets ML-KEM-1024 ciphertext [, 1 octet algorithm ID in case of v3 PKESK], 1 octet length field of value <code>n</code>, <code>n</code> octets wrapped session key (<a href="#ecc-mlkem-pkesk" class="auto internal xref">Section 4.3.1</a>)</td>
            <td class="text-right" rowspan="1" colspan="1">
              <a href="#ecc-mlkem" class="auto internal xref">Section 4.2</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
            <td class="text-left" rowspan="1" colspan="1">ML-DSA-65+Ed25519</td>
            <td class="text-right" rowspan="1" colspan="1">32 octets Ed25519 public key (<a href="#tab-eddsa-artifacts" class="auto internal xref">Table 6</a>), 1952 octets ML-DSA-65 public key (<a href="#tab-mldsa-artifacts" class="auto internal xref">Table 7</a>)</td>
            <td class="text-right" rowspan="1" colspan="1">32 octets Ed25519 secret key (<a href="#tab-eddsa-artifacts" class="auto internal xref">Table 6</a>), 4032  octets ML-DSA-65 secret (<a href="#tab-mldsa-artifacts" class="auto internal xref">Table 7</a>)</td>
            <td class="text-right" rowspan="1" colspan="1">64 octets Ed25519 signature (<a href="#tab-eddsa-artifacts" class="auto internal xref">Table 6</a>), 3293 octets ML-DSA-65 signature (<a href="#tab-mldsa-artifacts" class="auto internal xref">Table 7</a>)</td>
            <td class="text-right" rowspan="1" colspan="1">N/A</td>
            <td class="text-right" rowspan="1" colspan="1">
              <a href="#ecc-mldsa" class="auto internal xref">Section 5.2</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
            <td class="text-left" rowspan="1" colspan="1">ML-DSA-87+Ed448</td>
            <td class="text-right" rowspan="1" colspan="1">57 octets Ed448 public key (<a href="#tab-eddsa-artifacts" class="auto internal xref">Table 6</a>),  2592 octets ML-DSA-87 public key (<a href="#tab-mldsa-artifacts" class="auto internal xref">Table 7</a>)</td>
            <td class="text-right" rowspan="1" colspan="1">57 octets Ed448 secret key (<a href="#tab-eddsa-artifacts" class="auto internal xref">Table 6</a>), 4896 octets ML-DSA-87 secret (<a href="#tab-mldsa-artifacts" class="auto internal xref">Table 7</a>)</td>
            <td class="text-right" rowspan="1" colspan="1">114 octets Ed448 signature (<a href="#tab-eddsa-artifacts" class="auto internal xref">Table 6</a>), 4595 octets ML-DSA-87 signature (<a href="#tab-mldsa-artifacts" class="auto internal xref">Table 7</a>)</td>
            <td class="text-right" rowspan="1" colspan="1">N/A</td>
            <td class="text-right" rowspan="1" colspan="1">
              <a href="#ecc-mldsa" class="auto internal xref">Section 5.2</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
            <td class="text-left" rowspan="1" colspan="1">SLH-DSA-SHAKE-128s</td>
            <td class="text-right" rowspan="1" colspan="1">32 octets public key (<a href="#slhdsa-artifact-lengths" class="auto internal xref">Table 9</a>)</td>
            <td class="text-right" rowspan="1" colspan="1">64 octets secret key (<a href="#slhdsa-artifact-lengths" class="auto internal xref">Table 9</a>)</td>
            <td class="text-right" rowspan="1" colspan="1">7856 octets signature (<a href="#slhdsa-artifact-lengths" class="auto internal xref">Table 9</a>)</td>
            <td class="text-right" rowspan="1" colspan="1">N/A</td>
            <td class="text-right" rowspan="1" colspan="1">
              <a href="#slhdsa" class="auto internal xref">Section 6.1</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
            <td class="text-left" rowspan="1" colspan="1">SLH-DSA-SHAKE-128f</td>
            <td class="text-right" rowspan="1" colspan="1">32 octets public key (<a href="#slhdsa-artifact-lengths" class="auto internal xref">Table 9</a>)</td>
            <td class="text-right" rowspan="1" colspan="1">64 octets secret key (<a href="#slhdsa-artifact-lengths" class="auto internal xref">Table 9</a>)</td>
            <td class="text-right" rowspan="1" colspan="1">17088 octets signature (<a href="#slhdsa-artifact-lengths" class="auto internal xref">Table 9</a>)</td>
            <td class="text-right" rowspan="1" colspan="1">N/A</td>
            <td class="text-right" rowspan="1" colspan="1">
              <a href="#slhdsa" class="auto internal xref">Section 6.1</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
            <td class="text-left" rowspan="1" colspan="1">SLH-DSA-SHAKE-256s</td>
            <td class="text-right" rowspan="1" colspan="1">64 octets public key (<a href="#slhdsa-artifact-lengths" class="auto internal xref">Table 9</a>)</td>
            <td class="text-right" rowspan="1" colspan="1">128 octets secret key (<a href="#slhdsa-artifact-lengths" class="auto internal xref">Table 9</a>)</td>
            <td class="text-right" rowspan="1" colspan="1">29792 octets signature (<a href="#slhdsa-artifact-lengths" class="auto internal xref">Table 9</a>)</td>
            <td class="text-right" rowspan="1" colspan="1">N/A</td>
            <td class="text-right" rowspan="1" colspan="1">
              <a href="#slhdsa" class="auto internal xref">Section 6.1</a>
</td>
          </tr>
        </tbody>
      </table>
</div>
</section>
</div>
<div id="changelog">
<section id="section-12">
      <h2 id="name-changelog">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-changelog" class="section-name selfRef">Changelog</a>
      </h2>
<div id="draft-wussler-openpgp-pqc-01">
<section id="section-12.1">
        <h3 id="name-draft-wussler-openpgp-pqc-0">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-draft-wussler-openpgp-pqc-0" class="section-name selfRef">draft-wussler-openpgp-pqc-01</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-12.1-1.1">
            <p id="section-12.1-1.1.1">Shifted the algorithm IDs by 4 to align with the crypto-refresh.<a href="#section-12.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.1-1.2">
            <p id="section-12.1-1.2.1">Renamed v5 packets into v6 to align with the crypto-refresh.<a href="#section-12.1-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.1-1.3">
            <p id="section-12.1-1.3.1">Defined IND-CCA2 security for KDF and key combination.<a href="#section-12.1-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.1-1.4">
            <p id="section-12.1-1.4.1">Added explicit key generation procedures.<a href="#section-12.1-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.1-1.5">
            <p id="section-12.1-1.5.1">Changed the key combination KMAC salt.<a href="#section-12.1-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.1-1.6">
            <p id="section-12.1-1.6.1">Mandated Parameter ID check in SPHINCS+ signature verification.<a href="#section-12.1-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.1-1.7">
            <p id="section-12.1-1.7.1">Fixed key share size for Kyber-768.<a href="#section-12.1-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.1-1.8">
            <p id="section-12.1-1.8.1">Added "Preliminaries" section.<a href="#section-12.1-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.1-1.9">
            <p id="section-12.1-1.9.1">Fixed IANA considerations.<a href="#section-12.1-1.9.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="draft-wussler-openpgp-pqc-02">
<section id="section-12.2">
        <h3 id="name-draft-wussler-openpgp-pqc-02">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-draft-wussler-openpgp-pqc-02" class="section-name selfRef">draft-wussler-openpgp-pqc-02</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-12.2-1.1">
            <p id="section-12.2-1.1.1">Added the ephemeral and public key in the ECC key derivation function.<a href="#section-12.2-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.2-1.2">
            <p id="section-12.2-1.2.1">Removed public key hash from key combiner.<a href="#section-12.2-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.2-1.3">
            <p id="section-12.2-1.3.1">Allowed v3 PKESKs and v4 keys with PQ algorithms, limiting them to AES
symmetric ciphers.
for encryption with SEIPDv1, in line with the crypto-refresh.<a href="#section-12.2-1.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="draft-wussler-openpgp-pqc-03">
<section id="section-12.3">
        <h3 id="name-draft-wussler-openpgp-pqc-03">
<a href="#section-12.3" class="section-number selfRef">12.3. </a><a href="#name-draft-wussler-openpgp-pqc-03" class="section-name selfRef">draft-wussler-openpgp-pqc-03</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-12.3-1.1">
            <p id="section-12.3-1.1.1">Replaced round 3 submission with NIST PQC Draft Standards FIPS 203, 204, 205.<a href="#section-12.3-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.3-1.2">
            <p id="section-12.3-1.2.1">Added consideration about security level for hashes.<a href="#section-12.3-1.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="draft-wussler-openpgp-pqc-04">
<section id="section-12.4">
        <h3 id="name-draft-wussler-openpgp-pqc-04">
<a href="#section-12.4" class="section-number selfRef">12.4. </a><a href="#name-draft-wussler-openpgp-pqc-04" class="section-name selfRef">draft-wussler-openpgp-pqc-04</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-12.4-1.1">
            <p id="section-12.4-1.1.1">Added Johannes Roth as author<a href="#section-12.4-1.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="draft-ietf-openpgp-pqc-00">
<section id="section-12.5">
        <h3 id="name-draft-ietf-openpgp-pqc-00">
<a href="#section-12.5" class="section-number selfRef">12.5. </a><a href="#name-draft-ietf-openpgp-pqc-00" class="section-name selfRef">draft-ietf-openpgp-pqc-00</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-12.5-1.1">
            <p id="section-12.5-1.1.1">Renamed draft<a href="#section-12.5-1.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="draft-ietf-openpgp-pqc-01">
<section id="section-12.6">
        <h3 id="name-draft-ietf-openpgp-pqc-01">
<a href="#section-12.6" class="section-number selfRef">12.6. </a><a href="#name-draft-ietf-openpgp-pqc-01" class="section-name selfRef">draft-ietf-openpgp-pqc-01</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-12.6-1.1">
            <p id="section-12.6-1.1.1">Mandated <code>AES-256</code> as mandatory to implement.<a href="#section-12.6-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.6-1.2">
            <p id="section-12.6-1.2.1">Added <code>AES-256</code> / <code>AES-128</code> with <code>OCB</code> implicitly to v1/v2 SEIPD preferences of "PQ(/T) certificates".<a href="#section-12.6-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.6-1.3">
            <p id="section-12.6-1.3.1">Added a recommendation to use <code>AES-256</code> when possible.<a href="#section-12.6-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.6-1.4">
            <p id="section-12.6-1.4.1">Swapped the optional v3 PKESK algorithm identifier with length octet in order to align with X25519 and X448.<a href="#section-12.6-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.6-1.5">
            <p id="section-12.6-1.5.1">Fixed ML-DSA private key size.<a href="#section-12.6-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.6-1.6">
            <p id="section-12.6-1.6.1">Added test vectors.<a href="#section-12.6-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.6-1.7">
            <p id="section-12.6-1.7.1">Correction and completion of IANA instructions.<a href="#section-12.6-1.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="draft-ietf-openpgp-pqc-02">
<section id="section-12.7">
        <h3 id="name-draft-ietf-openpgp-pqc-02">
<a href="#section-12.7" class="section-number selfRef">12.7. </a><a href="#name-draft-ietf-openpgp-pqc-02" class="section-name selfRef">draft-ietf-openpgp-pqc-02</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-12.7-1.1">
            <p id="section-12.7-1.1.1">Removed git rebase artifact.<a href="#section-12.7-1.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="draft-ietf-openpgp-pqc-03">
<section id="section-12.8">
        <h3 id="name-draft-ietf-openpgp-pqc-03">
<a href="#section-12.8" class="section-number selfRef">12.8. </a><a href="#name-draft-ietf-openpgp-pqc-03" class="section-name selfRef">draft-ietf-openpgp-pqc-03</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-12.8-1.1">
            <p id="section-12.8-1.1.1">Updated SLH-DSA by removing parametrization and restricting to three SLH-DSA-SHAKE algorithm code points.<a href="#section-12.8-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.8-1.2">
            <p id="section-12.8-1.2.1">Removed NIST and Brainpool curve hybrids, dropped ECDSA from the current specification.<a href="#section-12.8-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.8-1.3">
            <p id="section-12.8-1.3.1">Updated KDF as proposed at IETF 119.<a href="#section-12.8-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.8-1.4">
            <p id="section-12.8-1.4.1">Removed whitespaces from composite algorithm names.<a href="#section-12.8-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.8-1.5">
            <p id="section-12.8-1.5.1">Explicitly disallowed SED (tag 9) and weak hashes when using PQ algorithms.<a href="#section-12.8-1.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="contributors">
<section id="section-13">
      <h2 id="name-contributors">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<p id="section-13-1">Stephan Ehlen (BSI)<br>
Carl-Daniel Hailfinger (BSI)<br>
Andreas Huelsing (TU Eindhoven)<a href="#section-13-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-14">
      <h2 id="name-references">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-14.1">
        <h3 id="name-normative-references">
<a href="#section-14.1" class="section-number selfRef">14.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-openpgp-crypto-refresh">[I-D.ietf-openpgp-crypto-refresh]</dt>
        <dd>
<span class="refAuthor">Wouters, P.</span>, <span class="refAuthor">Huigens, D.</span>, <span class="refAuthor">Winter, J.</span>, and <span class="refAuthor">N. Yutaka</span>, <span class="refTitle">"OpenPGP"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-openpgp-crypto-refresh-13</span>, <time datetime="2024-01-04" class="refDate">4 January 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-openpgp-crypto-refresh-13">https://datatracker.ietf.org/doc/html/draft-ietf-openpgp-crypto-refresh-13</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3394">[RFC3394]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span> and <span class="refAuthor">R. Housley</span>, <span class="refTitle">"Advanced Encryption Standard (AES) Key Wrap Algorithm"</span>, <span class="seriesInfo">RFC 3394</span>, <span class="seriesInfo">DOI 10.17487/RFC3394</span>, <time datetime="2002-09" class="refDate">September 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3394">https://www.rfc-editor.org/rfc/rfc3394</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7748">[RFC7748]</dt>
        <dd>
<span class="refAuthor">Langley, A.</span>, <span class="refAuthor">Hamburg, M.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Elliptic Curves for Security"</span>, <span class="seriesInfo">RFC 7748</span>, <span class="seriesInfo">DOI 10.17487/RFC7748</span>, <time datetime="2016-01" class="refDate">January 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7748">https://www.rfc-editor.org/rfc/rfc7748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8032">[RFC8032]</dt>
      <dd>
<span class="refAuthor">Josefsson, S.</span> and <span class="refAuthor">I. Liusvaara</span>, <span class="refTitle">"Edwards-Curve Digital Signature Algorithm (EdDSA)"</span>, <span class="seriesInfo">RFC 8032</span>, <span class="seriesInfo">DOI 10.17487/RFC8032</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8032">https://www.rfc-editor.org/rfc/rfc8032</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-14.2">
        <h3 id="name-informative-references">
<a href="#section-14.2" class="section-number selfRef">14.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="BDPA08">[BDPA08]</dt>
        <dd>
<span class="refAuthor">Bertoni, G.</span>, <span class="refAuthor">Daemen, J.</span>, <span class="refAuthor">Peters, M.</span>, and <span class="refAuthor">G. Assche</span>, <span class="refTitle">"On the Indifferentiability of the Sponge Construction"</span>, <time datetime="2008" class="refDate">2008</time>, <span>&lt;<a href="https://doi.org/10.1007/978-3-540-78967-3_11">https://doi.org/10.1007/978-3-540-78967-3_11</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CS03">[CS03]</dt>
        <dd>
<span class="refAuthor">Cramer, R.</span> and <span class="refAuthor">V. Shoup</span>, <span class="refTitle">"Design and Analysis of Practical Public-Key Encryption Schemes Secure against Adaptive Chosen Ciphertext Attack"</span>, <time datetime="2003" class="refDate">2003</time>, <span>&lt;<a href="https://doi.org/10.1137/S0097539702403773">https://doi.org/10.1137/S0097539702403773</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FIPS-203">[FIPS-203]</dt>
        <dd>
<span class="refAuthor">National Institute of Standards and Technology</span>, <span class="refTitle">"Module-Lattice-Based Key-Encapsulation Mechanism Standard"</span>, <time datetime="2023-08" class="refDate">August 2023</time>, <span>&lt;<a href="https://doi.org/10.6028/NIST.FIPS.203.ipd">https://doi.org/10.6028/NIST.FIPS.203.ipd</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FIPS-204">[FIPS-204]</dt>
        <dd>
<span class="refAuthor">National Institute of Standards and Technology</span>, <span class="refTitle">"Module-Lattice-Based Digital Signature Standard"</span>, <time datetime="2023-08" class="refDate">August 2023</time>, <span>&lt;<a href="https://doi.org/10.6028/NIST.FIPS.204.ipd">https://doi.org/10.6028/NIST.FIPS.204.ipd</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FIPS-205">[FIPS-205]</dt>
        <dd>
<span class="refAuthor">National Institute of Standards and Technology</span>, <span class="refTitle">"Stateless Hash-Based Digital Signature Standard"</span>, <time datetime="2023-08" class="refDate">August 2023</time>, <span>&lt;<a href="https://doi.org/10.6028/NIST.FIPS.205.ipd">https://doi.org/10.6028/NIST.FIPS.205.ipd</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="GHP18">[GHP18]</dt>
        <dd>
<span class="refAuthor">Giacon, F.</span>, <span class="refAuthor">Heuer, F.</span>, and <span class="refAuthor">B. Poettering</span>, <span class="refTitle">"KEM Combiners"</span>, <time datetime="2018" class="refDate">2018</time>, <span>&lt;<a href="https://doi.org/10.1007/978-3-319-76578-5_7">https://doi.org/10.1007/978-3-319-76578-5_7</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-pquip-pqt-hybrid-terminology">[I-D.ietf-pquip-pqt-hybrid-terminology]</dt>
        <dd>
<span class="refAuthor">D, F.</span> and <span class="refAuthor">M. P</span>, <span class="refTitle">"Terminology for Post-Quantum Traditional Hybrid Schemes"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-pquip-pqt-hybrid-terminology-03</span>, <time datetime="2024-05-09" class="refDate">9 May 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-pquip-pqt-hybrid-terminology-03">https://datatracker.ietf.org/doc/html/draft-ietf-pquip-pqt-hybrid-terminology-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NIST-PQC">[NIST-PQC]</dt>
        <dd>
<span class="refAuthor">Chen, L.</span>, <span class="refAuthor">Moody, D.</span>, and <span class="refAuthor">Y. Liu</span>, <span class="refTitle">"Post-Quantum Cryptography Standardization"</span>, <time datetime="2016-12" class="refDate">December 2016</time>, <span>&lt;<a href="https://csrc.nist.gov/projects/post-quantum-cryptography/post-quantum-cryptography-standardization">https://csrc.nist.gov/projects/post-quantum-cryptography/post-quantum-cryptography-standardization</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NISTIR-8413">[NISTIR-8413]</dt>
        <dd>
<span class="refAuthor">Alagic, G.</span>, <span class="refAuthor">Apon, D.</span>, <span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Dang, Q.</span>, <span class="refAuthor">Dang, T.</span>, <span class="refAuthor">Kelsey, J.</span>, <span class="refAuthor">Lichtinger, J.</span>, <span class="refAuthor">Miller, C.</span>, <span class="refAuthor">Moody, D.</span>, <span class="refAuthor">Peralta, R.</span>, <span class="refAuthor">Perlner, R.</span>, <span class="refAuthor">Robinson, A.</span>, <span class="refAuthor">Smith-Tone, D.</span>, and <span class="refAuthor">Y. Liu</span>, <span class="refTitle">"Status Report on the Third Round of the NIST Post-Quantum Cryptography Standardization Process"</span>, <span class="seriesInfo">NIST IR 8413 </span>, <time datetime="2022-09" class="refDate">September 2022</time>, <span>&lt;<a href="https://doi.org/10.6028/NIST.IR.8413-upd1">https://doi.org/10.6028/NIST.IR.8413-upd1</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SP800-56A">[SP800-56A]</dt>
        <dd>
<span class="refAuthor">Barker, E.</span>, <span class="refAuthor">Chen, L.</span>, <span class="refAuthor">Roginsky, A.</span>, <span class="refAuthor">Vassilev, A.</span>, and <span class="refAuthor">R. Davis</span>, <span class="refTitle">"Recommendation for Pair-Wise Key-Establishment Schemes Using Discrete Logarithm Cryptography"</span>, <span class="seriesInfo">NIST Special Publication 800-56A Rev. 3 </span>, <time datetime="2018-04" class="refDate">April 2018</time>, <span>&lt;<a href="https://doi.org/10.6028/NIST.SP.800-56Ar3">https://doi.org/10.6028/NIST.SP.800-56Ar3</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SP800-56C">[SP800-56C]</dt>
      <dd>
<span class="refAuthor">Barker, E.</span>, <span class="refAuthor">Chen, L.</span>, and <span class="refAuthor">R. Davis</span>, <span class="refTitle">"Recommendation for Key-Derivation Methods in Key-Establishment Schemes"</span>, <span class="seriesInfo">NIST Special Publication 800-56C Rev. 2 </span>, <time datetime="2020-08" class="refDate">August 2020</time>, <span>&lt;<a href="https://doi.org/10.6028/NIST.SP.800-56Cr2">https://doi.org/10.6028/NIST.SP.800-56Cr2</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
<div id="test-vectors">
<section id="appendix-A">
      <h2 id="name-test-vectors">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-test-vectors" class="section-name selfRef">Test Vectors</a>
      </h2>
<p id="appendix-A-1">To help implementing this specification a set of non-normative examples follow here.
The test vectors are implemented using the Initial Public Draft (IPD) variant of the ML-DSA and ML-KEM schemes.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div id="sample-v6-pqc-subkey-artifacts">
<section id="appendix-A.1">
        <h3 id="name-sample-v6-pqc-subkey-artifa">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-sample-v6-pqc-subkey-artifa" class="section-name selfRef">Sample v6 PQC Subkey Artifacts</a>
        </h3>
<p id="appendix-A.1-1">Here is a Private Key consisting of:<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.1-2.1">
            <p id="appendix-A.1-2.1.1">A v6 Ed25519 Private-Key packet<a href="#appendix-A.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-2.2">
            <p id="appendix-A.1-2.2.1">A v6 direct key self-signature<a href="#appendix-A.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-2.3">
            <p id="appendix-A.1-2.3.1">A User ID packet<a href="#appendix-A.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-2.4">
            <p id="appendix-A.1-2.4.1">A v6 positive certification self-signature<a href="#appendix-A.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-2.5">
            <p id="appendix-A.1-2.5.1">A v6 ML-KEM-ipd-768+X25519 Private-Subkey packet<a href="#appendix-A.1-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-2.6">
            <p id="appendix-A.1-2.6.1">A v6 subkey binding signature<a href="#appendix-A.1-2.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="appendix-A.1-3">The primary key has the fingerprint <code>52343242345254050219ceff286e9c8e479ec88757f95354388984a02d7d0b59</code>.<a href="#appendix-A.1-3" class="pilcrow">¶</a></p>
<p id="appendix-A.1-4">The subkey has the fingerprint <code>263e34b69938e753dc67ca8ee37652795135e0e16e48887103c11d7307df40ed</code>.<a href="#appendix-A.1-4" class="pilcrow">¶</a></p>
<div class="breakable lang-application/pgp-keys sourcecode" id="appendix-A.1-5">
<pre>
-----BEGIN PGP PRIVATE KEY BLOCK-----

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
/d8lkIgM
-----END PGP PRIVATE KEY BLOCK-----
</pre><a href="#appendix-A.1-5" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1-6">Here is the corresponding Public Key consisting of:<a href="#appendix-A.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.1-7.1">
            <p id="appendix-A.1-7.1.1">A v6 Ed25519 Public-Key packet<a href="#appendix-A.1-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-7.2">
            <p id="appendix-A.1-7.2.1">A v6 direct key self-signature<a href="#appendix-A.1-7.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-7.3">
            <p id="appendix-A.1-7.3.1">A User ID packet<a href="#appendix-A.1-7.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-7.4">
            <p id="appendix-A.1-7.4.1">A v6 positive certification self-signature<a href="#appendix-A.1-7.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-7.5">
            <p id="appendix-A.1-7.5.1">A v6 ML-KEM-ipd-768+X25519 Public-Subkey packet<a href="#appendix-A.1-7.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-7.6">
            <p id="appendix-A.1-7.6.1">A v6 subkey binding signature<a href="#appendix-A.1-7.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div class="lang-application/pgp-keys sourcecode" id="appendix-A.1-8">
<pre>
-----BEGIN PGP PUBLIC KEY BLOCK-----

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
-----END PGP PUBLIC KEY BLOCK-----
</pre><a href="#appendix-A.1-8" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1-9">Here is an unsigned message "Testing\n" encrypted to this key:<a href="#appendix-A.1-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.1-10.1">
            <p id="appendix-A.1-10.1.1">A v6 PKESK<a href="#appendix-A.1-10.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-10.2">
            <p id="appendix-A.1-10.2.1">A v2 SEIPD<a href="#appendix-A.1-10.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="appendix-A.1-11">The hex-encoded SHA3-256 <code>ecdhKeyShare</code> input is <code>c3bcf24924717f82614c331cc13eea1c333ab16c6d42a6f958cbeb48aa4260fb</code>.<a href="#appendix-A.1-11" class="pilcrow">¶</a></p>
<p id="appendix-A.1-12">The hex-encoded SHA3-256 <code>mlkemKeyShare</code> input is <code>9e956c105e25da824d6f1fddbbd93b920dd33f2fd647cfcb859904966efff31a</code>.<a href="#appendix-A.1-12" class="pilcrow">¶</a></p>
<p id="appendix-A.1-13">The hex-encoded SHA3-256 output is <code>99229561bcf5017d6b1dd34d8eb0441897968d5b140597756db705f1de67c078</code>.<a href="#appendix-A.1-13" class="pilcrow">¶</a></p>
<p id="appendix-A.1-14">The hex-encoded session key is <code>0e7d04eb84f066d0943c7898db8d36959203bdecdfb3e17e5fd3a24a13641d7b</code>.<a href="#appendix-A.1-14" class="pilcrow">¶</a></p>
<div class="lang-application/pgp-keys sourcecode" id="appendix-A.1-15">
<pre>
-----BEGIN PGP MESSAGE-----

wcPtBiEGJj40tpk451PcZ8qO43ZSeVE14OFuSIhxA8EdcwffQO1pvDRTpyIxERdP
Zf0JNCpG7uBqOXUty4vHAu/wCUmXFiutlBnRlG9O2jx2gaNp/HpAQeYmHwdDroFo
MGisG0RVOigKCVqjEgSCwmk0KLyGl6jFowNA9cMfi/pf6uU9PaweMGWmlgVyXDr0
2qf/jsjEx87yeL3t6yi2YIFXCitLc+vaqWjd3/8qBOcoTf/TpPXMNPmzmffh8xZx
bU25jlzB25dHXRLmwnFUlz3PU7voCQNhBtJiMSXmCzbb26BWrB+YVNvxStokvDBG
pnP+lGcUIJUJpPgSoJeZLp5CWSl/UPTiuz6blsddWpfYm8wa/7V/EzmZNKkvDZt4
7vdaXBaZDnPsMTE1Tn/FIc6/13CUe2rHDqcdLKIQ1bKRTpWH2BGqaX9a71XmxgR2
kdTZ067m4xeRRGidL7/A5qklIEMumL+IyjC4zDvgtHBaGyCeDD12nK7paGhfuTxj
Qn4SQQvDvswUnUlmfPQbdMV1H02+lWHk7i4QpK2vrnKOd6O7pOnWFQSMGg/L4lCx
pfztFSf5bUrYSrf/VoQJdfqLwTZ0cw8uQC7eoEOn419DcKOQA1G/cKNY/lSeYZMD
IAAMZZ6iIzXcSvwd5NZkISVuZO1uh/9rhg4ZTOb+rcI6RYb5GHQbEvFAw1RUNk28
4Vr1F2aYPuYw2rltNlE/D2jns6+9inJYnDmExbWX7hIItJVwwhGPqW0s0bbntFZD
zqlivMUoiCla49ZNQ6m7t5HwEv7IUZcNz5PvHvy5SPlFuzAJf82bKPYhAaCC1fE9
IBQEVLG9Kw+duKgS2HtKndNd9sN3Edgf24JpM6OzhjIfuO8hUUUSl88mh3YlBKmp
xbBHd01s6rr2WK/L4KifiL+Bi99k0QJjVRx4mgv5uKv6sdFKmBkcSIr6olNG5GHR
hWCKuNvIg0zL9WSB8Qeav4s6sCn4gEWgyLXZ33tF39OwJFGZJtk+F01hNrISCylW
cQ39tM58hK2vuqAFjvvyHmjwrQDnGMfOh+86yMipIrWF7AfzB+BVdWOkBynRMgws
45Ne2D4XyD6z8rgKqrQEKWspHdeYOxhmtLZFpg5uO06I6T944whwXWYTeGjBPsi2
YJuWlgH1nuZ+sw1FTE93XCfRHiLNQ6wBYCI9Usw9abAmW7Jhxd0/Kx72BbwLDmWm
vD1iXsgyCA1uyAfj89Xs5EIhPXFsxE6dfJ13dZGJVZl6mRJwjJgZStSEycvtsbtU
84tj9A+XpPfyCmk7wIte1d71vPE3s8Wx1WFYSiwPyVJS/AALSvPdEs4vhON7EQOa
xmhX1xITEesRXKhfKynhfMPpOUPgP1ctkpAbC8RGsRtEyhnALgHYqBYCULP+Pbmk
x34Z3pYlVXaWqiU0VJobuMwQJvnvax0ipFOPFYr6HBYvAuUlCdD17phL7ZFmLQjY
qstC0VS7E3mpvzbpo2uR1RDvWf6x6YFPAQoI9ltJ1S/lQdeLVh1+FOXuXh57qMcp
rD9h0SH7PihV9SRdvR2vvWyn7ygFNPajy/8PTH15eEv/5g6ZWxs5CKvpz0hTqf8C
0lQCCQIMslhjNg7KUOTtedOwUxvAoHK/lZf4fpMbG2GW7r6OHwShQ/zNruQmR8qV
qJsN7xv8+utysXtt6SUgMPnF3oUp9HzBnCwHb/m/di69xNsYQAE=
-----END PGP MESSAGE-----
</pre><a href="#appendix-A.1-15" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="v4-pqc-subkey-artifacts">
<section id="appendix-A.2">
        <h3 id="name-v4-pqc-subkey-artifacts">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-v4-pqc-subkey-artifacts" class="section-name selfRef">V4 PQC Subkey Artifacts</a>
        </h3>
<p id="appendix-A.2-1">Here is a Private Key consisting of:<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.2-2.1">
            <p id="appendix-A.2-2.1.1">A v4 Ed25519 Private-Key packet<a href="#appendix-A.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-2.2">
            <p id="appendix-A.2-2.2.1">A User ID packet<a href="#appendix-A.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-2.3">
            <p id="appendix-A.2-2.3.1">A v4 positive certification self-signature<a href="#appendix-A.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-2.4">
            <p id="appendix-A.2-2.4.1">A v4 ECDH (Curve25519) Private-Subkey packet<a href="#appendix-A.2-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-2.5">
            <p id="appendix-A.2-2.5.1">A v4 subkey binding signature<a href="#appendix-A.2-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-2.6">
            <p id="appendix-A.2-2.6.1">A v4 ML-KEM-ipd-768+X25519 Private-Subkey packet<a href="#appendix-A.2-2.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-2.7">
            <p id="appendix-A.2-2.7.1">A v4 subkey binding signature<a href="#appendix-A.2-2.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="appendix-A.2-3">The primary key has the fingerprint <code>b2e9b532d55bd6287ec79e17c62adc0ddd1edd73</code>.<a href="#appendix-A.2-3" class="pilcrow">¶</a></p>
<p id="appendix-A.2-4">The ECDH subkey has the fingerprint <code>95bed3c63f295e7b980b6a2b93b3233faf28c9d2</code>.<a href="#appendix-A.2-4" class="pilcrow">¶</a></p>
<p id="appendix-A.2-5">The ML-KEM-ipd-768+X25519 subkey has the fingerprint <code>bd67d98388813e88bf3490f3e440cfbaffd6f357</code>.<a href="#appendix-A.2-5" class="pilcrow">¶</a></p>
<div class="breakable lang-application/pgp-keys sourcecode" id="appendix-A.2-6">
<pre>
-----BEGIN PGP PRIVATE KEY BLOCK-----

xVgEUdDGgBYJKwYBBAHaRw8BAQdAhoSK5cJt9N37EE1UjPqp8EXhAvOBCYikgtcg
HMUso9MAAPwIdkHSrZmM4/Res+3qv1UT7kV5OAr6VO0M2P0ZPdAFiBICzS5QUUMg
dXNlciAoVGVzdCBLZXkpIDxwcWMtdGVzdC1rZXlAZXhhbXBsZS5jb20+wo8EExYK
AEEFAlHQxoAJEMYq3A3dHt1zFiEEsum1MtVb1ih+x54XxircDd0e3XMCGwMCHgkC
GQEDCwkHAxUKCAIWAAUnCQIHAgAAooUA/jV775USotWqnMYHmrqaCWsUduO0cLxS
4U7CuItZnfMJAPwLAyXS8awEJ92Ll52fQ2ESsAkJ4f/cjdHoP9V+BZbSBsddBFHQ
xoASCisGAQQBl1UBBQEBB0Dfrrz6gEv3iM2ULhupwUD4qABPIAwaNyVYDT2euXaS
dgMBCgkAAP9Q+XMh/cX9bvDH6mbpoGjZkeYkw1NO6y5NQEDmvDnEIBN+wngEGBYK
ACoFAlHQxoAJEMYq3A3dHt1zFiEEsum1MtVb1ih+x54XxircDd0e3XMCGwwAAI/D
AP9yG1KzQlWnMNMjyvpkxWhAjyIVxbtr+4WsXUdTqMMQkgD/SeI376LSUoB6s/oL
P10oFOJ86NjwfawQvIqa0CPIkgfHzYkEUdDGgGnWzS/qVrM3Wy7ifldXrJMRIq+r
iGRtWY4Hr1s0GXm+fmMDoLIGUnUCOM0BzzdQgEAcnlVFCZQ4NmlwbChkHI5nFiIl
cGQhrqzzxOzhPJrniyRZJMb3gBMXQO6yCx66G7fHAJ73J1AcFTNWyszaIcXnazHX
OBSpnSMrvQfZIfV3tyW2Xhg6KjhDD6/TsrBiigPGGlZwcPtAh/EbkwR1xYlnU0mX
tlwrlHgWvkwlcXOgdz4VUiDGPIJRGIh6LXe1dobCUjYVZPEKmf9TN2o8oSiVRr8L
GZF1jXyqLlHloMSbJiV1m6iZH8DjTWMBYRRAOVr1Ly7MDqrwJoN0CQFnx/Hqum+2
czgxlsWLtGvADUwaPodwH9MHp4tXJ/HsOOO7z6bYdCNpAySqpSmzCaNzlXppw54n
bD+0UE70dxh0UHiGnoJQXy5mkcG2gTWpwC7bZ+nbCBgcJF/IHBbIWbYQVLDTeP+z
LKnDt/iAoJ5qgeF1wuC7pwsaQy7EUZgClZ0ivkdLyC6ZImikkaczV/VcrxeZZRqC
GqfxQ05QJOAiGFNhvBvDclXcaXYWibxQgyFlGUM1rbR8XZJzVjbihw0pfiVnustU
xYhsroqybX6iJVdAxVNiZwrMZ4VqifErJ1lYbYImF+jKQ6/zYZrrODDmLy0xZqhq
mC5jsE1owzTDzEPnibtTEWiKbShTmJmxbhtQwhW7jsvKhQXbSvr7Nsh0vXzWEGim
IkpBEXycePOnVSens94Rpa2jqgjLJhgalqocm07pNXFMeyJAhYVnHUuCsQzgrkNc
ncbVe85GzsW6S/8MzdtKD9MGy3XHlKKByeF1oxcWEnBEQZ4JhpOmIHV7TVRhHa8L
tIQ4HmCADposq1OTiAbxfYP6RtiLyemxDJaFLdaDSRSXIf5ALgxaysUxe57Qh7uA
Qh5WejIJy6cDZtUYqtoLg8KDegxKSmo3hy2nsReMgc6SFU/ziHNWWQAtSjHrbFry
ruaAJAmVGKj2UoqACMQlDpZkQYF2po8byQx7TIGnXwmGisygomwjTGocO5LDqoyS
uORISmhcXbvcXtRWnQMafPAhpb6Sfm4JGic7W3/EcgmRcWiLnbnzNeBgirQgqTky
kBRMycBAzgglsq5CJOHWZOoJTvlBHXBiq3z2ddY4hzckCeqQYwCrn08qChsLHuX1
r5ZxFE+XE6+YRvwIYEKrBTDzxNppnZTMFkGhgHWXuZcSnYQAxiSbVHTkjvcEC3k8
HHGovlujZInkNlQGk2KQjCWCI2JgFvIBBcswMt8Jmr9Jpa4zvv08Zi60DJpWYonH
N+uSQ1FbxCm5tM6JJaKSjLYQxm6zfZ0Lxc0XP90SUKg4Ux+Al0y1jH7VgjWmGrP1
geoHgvP8RWlHbW+rhBWsYmAATawUdPZAg/rcODM0fzRpe5CWdnjIhRqUAjQruB4A
n2iXWu5DymzgV6ajOB/3VKxYvup0mRULOwZsqHHIzJGCxlesMIecccRUT2IWaxFJ
h4m1igg8zS9hG5/yQr3bJH2UbxX2o453u58wqvJBYOvhWDsITKAQMyhSD9iGA8Pq
AAs1utxWaATaNH1qvDxDrdiHCYadNeTVxYYb8HVRBLaWNlG1lYjvl+WGf5t9AMC5
EKxgiozRC4yyd1oYV1+fv8g5eMz2pBWB5tuvE5ootGtwzIWSkRmGUfEzZpLCIWAF
/9CWtmnPPiygQZecuzUDsTQRHnIANfWVhGZFmFh8qxc81IZKTPtgBMgW8ewE3oiJ
cac8BHo5cEiTxeVDXXqEMCOn4jQCtKU8+ogQLhF6OvVpV2A9eKlvVberhBqu2+lC
KDt2YpRjb2Bm5lqWDLUAiWa8rMTMwQmfybFp7Zi25pDPHpEwWvGGR6sjVYMfVRR8
HlOV6csYJTejEPghZih0dwEHdhUSe9Su+HNjsiunyNg042mGkOE/n1SGZ2cVkOMB
iwyDm4uo9bG8X9akvOdT4EA3Pfg5DLAOIUILJlsrBPBRvIG5bulUdOtMfkMMUHOF
O3O8FvyjpUc43tOgmvnEcCuuraqIjzokM6pHYjYjySmipMxFi8anwZIix/sUBclg
UtIMo0KBY+aTwDGoOJkERWp8zgdcplfLYYEzlCWhm1JAbabKQpummohwpUErZ9gy
1NtuMJhDxxtb8MMylwWHklpwhkFcLgW/rIkLEte15zuSiGcrOJYpUEpnP/edSdyn
YOutidNbg5tLxaZTiKYcUFcdZ1jI7ows9Ri4v4xJ6MxGJOSIPGWieDw1b9GTehS/
uCp++UJzCMQUYfHI/nYbDAyWPbx9piVkCIychNhrGurIqPMEUBCwXNF60hhGXlep
TLoldts3W0xX3ROmD8gPqEUa8pujI1oeULiL3vlfb1deXSu6evLMPoyWyRKEFCY0
+Fe1G2RX1CyjYKkW5heqWkJixHS7tItCksAgFTTCWcUammBEA8NUuEeg3jO8nVA4
aKFrfOoSrYbHqsmO1AJfCDh21iMUOVAefLTFIsavLuFO8OmOh7cXcOQWG6G5ZdUt
SQQxJJK6mKka5TZlp2GXyGzFVgdD1ddkMHMu9gB96SJjsodDQseklAldfft66xt6
UIbEVbwVCDctzPZ1o/pwKeu2GJa+D6RSEPNRrZeHF7OVq8pnnCQE/HUsrLcqPZhn
/8K5MvhphdmoUQl5fmQZoIRqRxFoDqFvJ/qETBsTwwkkgLwBzSEe4+ubbchq3Jp5
1LVmmZG5BxVe9UWzPirPqKXPu4oArjEqtRJ5MARI1NifzMvKJpGuqhMIh8UQraGf
KNJBxwN99Aq7GCYmkyYvo9wNUMJrYfa3TXh0GwBhqwxObtzAQZzGXGl9kVQEI9Q1
upTFQKgddScJIsoIdzSGfJlkVtSj6lsqmDdkHMPCa9yhk2Ikn9E/kbQ371ca2iZ2
4FAIIXHNeULH4qIc8ScjO1epIuerd9MLJdi5dwR9zAwNe8GznNGMi5HE2BJyS5gZ
8ht3/Xm88lIXRil6bnTOBYQ9RDoIHNU2EFamnBO9jUu92XBGqgRv9iKAVTmPr7i5
qMe8vEU0PeOjt2d4aHlZ/cO+NRO1YvHMQfxSGpjPQMRvUGoUAOOkndYVlGw3VzKw
7pFerytKJaozmpuGFCVLhlJYn9C6oeCfPQQjy1ydULIBe6DKUycbvAIjK3Qj4jum
I2dp8RV3JHRmcxWzngJuj7nFyfeKBecwZesMqXl3YwOgsgZSdQI4zQHPN1CAQBye
VUUJlDg2aXBsKGQcjmcWIiVwZCGurPPE7OE8mueLJFkkxveAExdA7rILHrobt8cA
nvcnUBwVM1bKzNohxedrMdc4FKmdIyu9B9kh9Xe3JbZeGDoqOEMPr9OysGKKA8Ya
VnBw+0CH8RuTBHXFiWdTSZe2XCuUeBa+TCVxc6B3PhVSIMY8glEYiHotd7V2hsJS
NhVk8QqZ/1M3ajyhKJVGvwsZkXWNfKouUeWgxJsmJXWbqJkfwONNYwFhFEA5WvUv
LswOqvAmg3QJAWfH8eq6b7ZzODGWxYu0a8ANTBo+h3Af0weni1cn8ew447vPpth0
I2kDJKqlKbMJo3OVemnDnidsP7RQTvR3GHRQeIaeglBfLmaRwbaBNanALttn6dsI
GBwkX8gcFshZthBUsNN4/7MsqcO3+ICgnmqB4XXC4LunCxpDLsRRmAKVnSK+R0vI
LpkiaKSRpzNX9VyvF5llGoIap/FDTlAk4CIYU2G8G8NyVdxpdhaJvFCDIWUZQzWt
tHxdknNWNuKHDSl+JWe6y1TFiGyuirJtfqIlV0DFU2JnCsxnhWqJ8SsnWVhtgiYX
6MpDr/Nhmus4MOYvLTFmqGqYLmOwTWjDNMPMQ+eJu1MRaIptKFOYmbFuG1DCFbuO
y8qFBdtK+vs2yHS9fNYQaKYiSkERfJx486dVJ6ez3hGlraOqCMsmGBqWqhybTuk1
cUx7IkCFhWcdS4KxDOCuQ1ydxtV7zkbOxbpL/wzN20oP0wbLdceUooHJ4XWjFxYS
cERBngmGk6YgdXtNVGEdrwu0hDgeYIAOmiyrU5OIBvF9g/pG2IvJ6bEMloUt1oNJ
FJch/kAuDFrKxTF7ntCHu4BCHlZ6MgnLpwNm1Riq2guDwoN6DEpKajeHLaexF4yB
zpIVT/OIc1ZZAC1KMetsWvKu5oAkCZUYqPZSioAIxCUOlmRBgXamjxvJDHtMgadf
CYaKzKCibCNMahw7ksOqjJK45EhKaFxdu9xe1FadAxp88CGlvpJ+bgkaJztbf8Ry
CZFxaIudufM14GCKtCCpOTKQFEzJwEDOCCWyrkIk4dZk6glO+UEdcGKrfPZ11jiH
NyQJ6pBjAKufTyoKGwse5fWvlnEUT5cTr5hG/AhgQqsFMPPE2mmdlMwWQaGAdZe5
lxKdhADGJJtUdOSO9wQLeTwccai+W6NkieQ2VAaTYpCMJYIjYmAW8gEFyzAy3wma
v0mlrjO+/TxmLrQMmlZiicc365JDUVvEKbm0zoklopKMthDGbrN9nQvFzRc/3RJQ
qDhTH4CXTLWMftWCNaYas/WB6geC8/xFaUdtb6uEFaxiYABNrBR09kCD+tw4MzR/
NGl7kJZ2eMiFGpQCNCu4HgCfaJda7kPKbOBXpqM4H/dUrFi+6nSZFQs7BmyoccjM
kYLGV6wwh5xxxFRPYhZrEUmHibWKCDzNL2Ebn/JCvdskfZRvFfajjne7nzCq8kFg
6+FYOwhMoBAzKFIP2IYDw+oACzW63FZoBNo0fWq8PEOt2IcJhp015NXFhhvwdVEE
tpY2UbWViO+X5YZ/m30EFhqD2sbN4HJ/Sv2SB7DadONGI5Sj0tnqRWZ//nA4CLZo
y1LriIK38pV3lBCLv2M9vynHoyXTFco3BqTUGUEjbDnCeAQYFgoAKgUCUdDGgAkQ
xircDd0e3XMWIQSy6bUy1VvWKH7HnhfGKtwN3R7dcwIbDAAA8PEA/16fgmhfrX12
GXFXcTGO8MKQTihxz2djD4aki7fVX+ZAAP9UT/A3jAfqvFNp+ecYkkZ8T+vnXR4P
0O22blDNAr/tDA==
=q5En
-----END PGP PRIVATE KEY BLOCK-----
</pre><a href="#appendix-A.2-6" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2-7">Here is the corresponding Public Key consisting of:<a href="#appendix-A.2-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.2-8.1">
            <p id="appendix-A.2-8.1.1">A v4 Ed25519 Public-Key packet<a href="#appendix-A.2-8.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-8.2">
            <p id="appendix-A.2-8.2.1">A User ID packet<a href="#appendix-A.2-8.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-8.3">
            <p id="appendix-A.2-8.3.1">A v4 positive certification self-signature<a href="#appendix-A.2-8.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-8.4">
            <p id="appendix-A.2-8.4.1">A v4 ECDH (Curve25519) Public-Subkey packet<a href="#appendix-A.2-8.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-8.5">
            <p id="appendix-A.2-8.5.1">A v4 subkey binding signature<a href="#appendix-A.2-8.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-8.6">
            <p id="appendix-A.2-8.6.1">A v4 ML-KEM-ipd-768+X25519 Public-Subkey packet<a href="#appendix-A.2-8.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-8.7">
            <p id="appendix-A.2-8.7.1">A v4 subkey binding signature<a href="#appendix-A.2-8.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div class="lang-application/pgp-keys sourcecode" id="appendix-A.2-9">
<pre>
-----BEGIN PGP PUBLIC KEY BLOCK-----

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
=dPFW
-----END PGP PUBLIC KEY BLOCK-----
</pre><a href="#appendix-A.2-9" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2-10">Here is an SEIPDv1 unsigned message "Testing\n" encrypted to this key:<a href="#appendix-A.2-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.2-11.1">
            <p id="appendix-A.2-11.1.1">A v3 PKESK<a href="#appendix-A.2-11.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-11.2">
            <p id="appendix-A.2-11.2.1">A v1 SEIPD<a href="#appendix-A.2-11.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="appendix-A.2-12">The hex-encoded SHA3-256 <code>ecdhKeyShare</code> input is <code>98782f4d20476dc2787ce8e264731e0d0cfeac0a35732cd88cc5518b57e634a0</code>.<a href="#appendix-A.2-12" class="pilcrow">¶</a></p>
<p id="appendix-A.2-13">The hex-encoded SHA3-256 <code>mlkemKeyShare</code> input is <code>3e8813445ee2a4a6f1a503d14149304f0ea4f626b45ed871e9381b967fb19008</code>.<a href="#appendix-A.2-13" class="pilcrow">¶</a></p>
<p id="appendix-A.2-14">The hex-encoded SHA3-256 output is <code>86ea88190089aae9256f04fdd09cd62e19f2c1d02cfb844aa1f99f7b17c49743</code>.<a href="#appendix-A.2-14" class="pilcrow">¶</a></p>
<p id="appendix-A.2-15">The hex-encoded session key is <code>f3037ae17d83a40ed08d884e19dc66065eac82d96337e4b74b1d10e933535e4d</code>.<a href="#appendix-A.2-15" class="pilcrow">¶</a></p>
<div class="lang-application/pgp-keys sourcecode" id="appendix-A.2-16">
<pre>
-----BEGIN PGP MESSAGE-----

wcPUA+RAz7r/1vNXaUNGH8CAkSiFgunnUDqAiD9JSd3Sb7lMNUsWk6lzWiJicgky
S/vu0sSnRtxweWkoMr1y2ZaS45nXbEQyShiqHhZUKfVwtxbU+rGVH5oCgSvtTCrs
verZaFpqzqPWyZ8ApzJvjbGUDBuwns09dGIKvKoePT5DCrqXlsW4EA8gFJbiXeb3
E7nsyg3l2uMzbt6FHtYoa6qq9Q0PsUiGte52nXXWEnmBOGUfmCkVsgmHDmz63BLT
1xXuZ5YopZkhhpjTNtvWtXc6MIaqnh6XtAcg8ZoaH0iferpbHEp9+M4bv5YDjzji
vv83rBQN4cBaS1/TSmBkNJHmxcyT1AOOXY2ZbmxQBORhGOTrFz3w8R78MYkEvB6x
JAjoYirpsyNLJzdewpXEYrPQq4Ey8EG2+qDY47vQkQaYcSFFoxYQ8MpHXmmgJ2bp
D13g/lQlSHcdWX2L59Wa1dhKRVnUyeEtO5c06FKJ7QOrywNjPdVciPVCx6bBfVd2
6qiWLynSGnzGaKd1YyaviioCm48Ydu5q8Z+QbEANbKW1azVAWCuxuiomE3RBvf1O
8d30UvBnImEf+9ANDxzmjIG2lW39U591Jbv0pL00at3tIMQN2wwiduP1KZ1dilWa
gEkdPjl6Q68ov0vRCYMAZizj4pMZbsUdge2Jj9GieObnp+w25pJu9nBeI6iqYmwd
Ny1U3OuvzbEUsNfKcHoQd9Cem8EZn+5ICk7eqsTkZq69oYfIVRyzEEc/X9562nzh
6B+X4CHZY/C8UCWougQriG4KVszM4myOgekKg0kNVIWgE2y7Z//S9c2twdxRWT/a
8QC4p7QX7JRgzDD9erkj/9J3hKwHxDHShKB5jsVaGO+BxtFSCiiTmgeo7+SAnJwU
Mi/N0UiI2BbKdo4KmdDPUVDyobBjCjeXil7Kg7pTU0vewPZQDLl9X16CcXCB60HL
fkDGpcYbjkZYbmB449sQfaLvxRMHomP4TY4PEfANIXdWmk1mS0/+zNzMQ9+Xderc
8P/EdKDKF5yr7IzSNoxuLiIWpyWJj+5QmAwup9mVv5gkh5RPnUQ0fgQ1vU8K9PMz
OmYqlX2W4gPn29UovjkbGH+lEzazEzA7VZWHXG86NVN8WMXqdQvMJcmMRZhDmC3F
kCII5zc6dxFXjNUgaAqV8eBqvRBbgCqK+6HSwCMY7jNFhFIy+Nj/9BYU/ereax0t
Zlsk7XDK9lMZUidh5+VeEqbyMsLQ0YiyO7VJ5VdiPESXHjPkzxo42XZJELuBVC9D
ArAX2Qip+oV1RXzhu/SeJdRQufGSENeZpGiG4tW24dpROh40I5TgXmpd4ALhuh1S
PrepCNhXuFtKDIStKZEmCknPAGWAkLYZz5rAaMtztdGvzlektn+8CDtSo3d6FUww
dp68ZtSMMb5HGscAoiDoOTiB5KVPSd80s3EPXlsgQSfHuSUHTvmD8G6q4hqGXMeV
IUdwjwTvDMfW7CU5zqiV01SO6dXKsFyjLJrT57kpCbQ/2fhoMC+kNcXpzI+Z65yI
jCP6Sjv+cVh7tv55kTKAPHO5VE3MDxvSOQHpUQ0zora+lfzpLUahfv8uZ4Q4J3L6
mkHfXuplyv3LcunejQDog2bhakqbrb5lg3fZGYNagykZxw==
=2Xhi
-----END PGP MESSAGE-----
</pre><a href="#appendix-A.2-16" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2-17">Here is an SEIPDv2 unsigned message <code>Testing\n</code> encrypted to this key:<a href="#appendix-A.2-17" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.2-18.1">
            <p id="appendix-A.2-18.1.1">A v6 PKESK<a href="#appendix-A.2-18.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-18.2">
            <p id="appendix-A.2-18.2.1">A v2 SEIPD<a href="#appendix-A.2-18.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="appendix-A.2-19">The hex-encoded SHA3-256 <code>ecdhKeyShare</code> input is <code>4a0b21ff26997b812f6e0381b7b4ff907ecc7abdec01f16ecbf60bdc3f633341</code>.<a href="#appendix-A.2-19" class="pilcrow">¶</a></p>
<p id="appendix-A.2-20">The hex-encoded SHA3-256 <code>mlkemKeyShare</code> input is <code>4c0c441f23711ed5d44983e2cbfc06799295029b92f627b161cd57f072e0ebd0</code>.<a href="#appendix-A.2-20" class="pilcrow">¶</a></p>
<p id="appendix-A.2-21">The hex-encoded SHA3-256 output is <code>76ea8fcc9a31a9fa672940b9ad578f6b8ecbea1b1d1175d01f1777364a8e2704</code>.<a href="#appendix-A.2-21" class="pilcrow">¶</a></p>
<p id="appendix-A.2-22">The hex-encoded session key is <code>b5d810efc6b2b82e77f907813e114587aca2d0e33c9c74e90eb1638df030dcaf</code>.<a href="#appendix-A.2-22" class="pilcrow">¶</a></p>
<div class="lang-application/pgp-keys sourcecode" id="appendix-A.2-23">
<pre>
-----BEGIN PGP MESSAGE-----

wcPhBhUEvWfZg4iBPoi/NJDz5EDPuv/W81dpZ1Yz1yu1Dk/HK2JuEmE6RavqzhvT
i508AZhPxC08BxfNFar+uyZCNyMrUSrY0qY8H61GTtx1+O9VynXl8uXtS1nTDGJ9
vCR+EvH6rT/gOPQB8HUhX6Ps97Yqi/Iys1gfS8n961pScwIYpPJzUWfUUKjIT55W
htkh9aIB6unqzwUDi3p4oRZRm67j1ZP14SLyonAG2tXtCZyu1An62UHeOyNl1/6Z
CgC3egTf6lz26US15T8AP54AO77LOf9KwLpUYcwvSExqHGgmhS0Mil6WnFyuJUDB
7A2T2p/koW7TDaqoxhWsxY2isiH1SmAxNxzMnrGd7rNpPJ/k/r42bILfOuG0TRUN
zqC9ph6OdydSyhHkN5G4eOYQqqvk19/lfLuHWlNwfNcn/2PsgsxLxNj7ltVn90W0
qLubPWrujn/DhLl+hs2xXDOudpcztUqxcBnrsSaHlaebjQoDfttVAQj2jjdNXRjZ
uNRnRfcG9s3sO3b8d4ed6tk6U+nMrE2dZCBjTagqvD07Z1TpZDh7t86V3X16o/ps
jxW42s+YR589b88IZcieZRbKVtXt00pn2tn95kpvL3d8nAkaiPUhrowQUz0jpn8c
CDBNAn1j690qM3pD5XJlwverC2cmJH1Hjobnrhi6X1k2lQxweX28p+R9NQjSoX0h
ORuE0/Wpi15y0xmr2EzjcZ/6vPncy/IrYJCYmx9+aWQAjrKjizzNFTt73kf1xba5
t4tbZkj9xgdDJXq3bAqB0/JeeTb4aTCk+n4olVYzCnMtLgj+1fWPClMModACmFOG
1+bw5Q91/7euo363sw5UwgU1JhSQ/xcKNyJQsnklWkLMJNB1Yhj/C32lEmLntigv
UOO510+ehA7D5ftef8cMfEIm73HrBBiLfixvVTR8AQV4hiV/mzKP7weM7kxvAvbz
ir4jt3uSBOuhTjzq2is/S3D2K+O8FZqGIbkDhnKd98LbEA2cn9nTfsbV+TVXCmaS
lHNojVxPL2pUKxedV5skvfflRFciuP7UNsf8myHe7wdfPdSzMsbytDEwID3vcsme
fBqZdEZxqv/mNnn38TfHMSCF+yv5XbF9ham4DIcqNlkYud1ipEFFbcBZ0o9nUIWp
diSY7KGAtVF224dtcr3FTHGuBnayDq+Yk++VhF4Bb3uPVuwrkf7Bncp1aYEQfkhI
HwF3X6GnwC3y7kpbkU1rOq7yXv/0mRyGpVQlW/Yf3qT1buxcWt5BvXBmKzbBpVg/
0B9vpzrlFsT0Pb2GHuQ6U+9JoZ+ePnRMVdDz93RCGr1kQlyY15K1b+yILJiV6oOL
OxoxXHnr5soIumxCqv+6oAm4SdQVJLELQK72x1dVKJ90jUOgYCeOY61NsC9BFWHT
h0itUEnwWMjKg73z00bthndwfEXHBJLrHizkcv+pwD8M5wb/9H6HU4x8ELSr5Fyn
WjSoa2739wmJkoJY5ifaic3L8UXJeLuEZnVG9tUrl9ohHO8RNR3Vc/uHmyhImoYp
RL4rcc6YpuyextmYu9S9LkPR5Bzr+mFeJDeXbA7GJm9eofdw0lQCCQIMAGc2j84/
tfivyP5YrgQ8uBt9iwJN3IYRBy8qdr9JUyxkpkOEshV6XE4g3Orpbx0ZdrxbKmDS
7eJl5fSust3gb2KfaAoWkFQivVJP2KTl5gw=
-----END PGP MESSAGE-----
</pre><a href="#appendix-A.2-23" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-B">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-B-1">Thanks to Daniel Huigens and Evangelos Karatsiolis for the early review and feedback on this document.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Stavros Kousidis</span></div>
<div dir="auto" class="left"><span class="org">BSI</span></div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:stavros.kousidis@bsi.bund.de" class="email">stavros.kousidis@bsi.bund.de</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Johannes Roth</span></div>
<div dir="auto" class="left"><span class="org">MTG AG</span></div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:johannes.roth@mtg.de" class="email">johannes.roth@mtg.de</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Falko Strenzke</span></div>
<div dir="auto" class="left"><span class="org">MTG AG</span></div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:falko.strenzke@mtg.de" class="email">falko.strenzke@mtg.de</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Aron Wussler</span></div>
<div dir="auto" class="left"><span class="org">Proton AG</span></div>
<div dir="auto" class="left"><span class="country-name">Switzerland</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:aron@wussler.it" class="email">aron@wussler.it</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
